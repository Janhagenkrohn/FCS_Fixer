


---------------------------------------------
---------------------------------------------
Creation:
2024-07-31, 13:00:00
0 output files generated so far.

Writing output into ../test_data/2ch_setup/20240731_1300_LLPS_dense_AF647_bleaching.

Overview over loaded TTTR data:
3661615 photons in total
Channels in use and how many photons are in each of them:
0: 1835553, 1: 1826062
60.00005465153024 s acquisition time
200 micro time bins
50.001400039201094 ns macro time resolution
0.24999999292951713 ns micro time resolution




---------------------------------------------
---------------------------------------------
set_correlation_time_params: Setting correlator settings
2024-07-31, 13:00:00
0 output files generated so far.

Parameters set:
  micro_time_corr (Use of micro time information in correlation): True
  sampling (number of samples per correlator cascade): 6
  n_casc (number of correlation cascades): 33.0
  



---------------------------------------------
---------------------------------------------
set_afterpulsing_params: Setting afterpulsing calibration parameters
2024-07-31, 13:00:00
0 output files generated so far.

loaded afterpulsing calibration file /fs/gpfs41/lv02/fileset02/pool/pool-schwille-spt/_Software/FCS_cleaner_dev/FCS_Fixer/functions/ap_params_2ch_setup.csv
  Parameters:
  A1[GHz], tau1[ns], A2[GHz], tau2[ns]:
  [[1.37470e-07 6.77435e+03 7.34693e-06 3.13849e+02]
 [3.06463e-07 7.43791e+03 4.10575e-06 3.10915e+02]]
  Channel-wise afterpulsing probabilities according to calibration:
  [0.0032371  0.00355598]
  



---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2024-07-31, 13:00:00
0 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 1835553




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2024-07-31, 13:00:00
0 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 1835553




---------------------------------------------
---------------------------------------------
afterpulse_correlation: Created afterpulsing prediction using biexponential model
(Called by correlation_apply_filters)
2024-07-31, 13:00:02
0 output files generated so far.

Expression:
  (A1 * exp(-t/tau1) + A2 * exp(-t/tau2)) * micro_time_gate_correction / (1 + (A1 * tau1 + A2 * tau2)) / count_rate
  Parameters used:
  channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
  A1 [GHz]: 1.3747e-07
  tau1 [ns]: 6774.349999999999
  A2 [GHz]: 7.346930000000001e-06
  tau2 [ns]: 313.849
  count rate [GHz]: 3.059252746287373e-05
  amplitude correction factor for afterpulses discarded by micro time gating: 1.0
  



---------------------------------------------
---------------------------------------------
correlation_apply_filters: Calculate correlation function applying various filters
(Called by get_correlation_uncertainty)
2024-07-31, 13:00:02
0 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((0,), ((), (0,)))
ext_indices specified: False
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
-> Actual shortest and longest lag times calculated [ns]: 1022.5286308016623, 939550401.9112535.
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Average count rates (considering corrections and weights) [GHz]:
First correlation channel: 3.059252746287373e-05
Second correlation channel: 3.059252746287373e-05

Calculated as auto-correlation function.




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2024-07-31, 13:00:02
0 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: True
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 337548




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2024-07-31, 13:00:02
0 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: True
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 337548




---------------------------------------------
---------------------------------------------
afterpulse_correlation: Created afterpulsing prediction using biexponential model
(Called by correlation_apply_filters)
2024-07-31, 13:00:02
0 output files generated so far.

Expression:
  (A1 * exp(-t/tau1) + A2 * exp(-t/tau2)) * micro_time_gate_correction / (1 + (A1 * tau1 + A2 * tau2)) / count_rate
  Parameters used:
  channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
  A1 [GHz]: 1.3747e-07
  tau1 [ns]: 6774.349999999999
  A2 [GHz]: 7.346930000000001e-06
  tau2 [ns]: 313.849
  count rate [GHz]: 5.625839006909308e-05
  amplitude correction factor for afterpulses discarded by micro time gating: 1.0
  



---------------------------------------------
---------------------------------------------
correlation_apply_filters: Calculate correlation function applying various filters
(Called by get_segment_ccs)
2024-07-31, 13:00:02
0 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((0,), ((), (0,)))
ext_indices specified: True
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
-> Actual shortest and longest lag times calculated [ns]: 1022.5286308016623, 939550401.9112535.
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Average count rates (considering corrections and weights) [GHz]:
First correlation channel: 5.625839006909308e-05
Second correlation channel: 5.625839006909308e-05

Calculated as auto-correlation function.




---------------------------------------------
---------------------------------------------
get_segment_ccs: Calculate correlation functions with filters for evenly spaces time segments of the measurement.
(Called by get_Wohland_SD)
2024-07-31, 13:00:04
1 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((0,), ((), (0,)))
minimum_window_length (shortest allowed window length) [s]: 6.000005465153025
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Split time trace of length 60.0 s into 10 segments, of which 10 were usable.
Wrote results to ../test_data/2ch_setup/20240731_1300_LLPS_dense_AF647_bleaching/00_segment_ACFs_ch0.csv/png



---------------------------------------------
---------------------------------------------
get_Wohland_SD: Calculate correlation functions uncertainty using Wohland method.
(Called by get_correlation_uncertainty)
2024-07-31, 13:00:04
1 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((0,), ((), (0,)))
minimum_window_length (shortest allowed window length) [s]: 6.000005465153024
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

  
Used 10 segments for uncertainty estimation.




---------------------------------------------
---------------------------------------------
get_correlation_uncertainty: Calculate correlation function and uncertainty.
(Called by 03_batch_processing.py)
2024-07-31, 13:00:04
2 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((0,), ((), (0,)))
default_uncertainty_method (whether to try Wohland method SD calculation or directly use bootstrap): Wohland
minimum_window_length (shortest allowed window length) [s]: []
n_bootstrap_reps (number of bootstrap replicates to perform) 10
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: None, None
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Results written to ../test_data/2ch_setup/20240731_1300_LLPS_dense_AF647_bleaching/01_ACF_ch0.csv/png



---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by get_trace_time_scale)
2024-07-31, 13:00:04
2 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 1835553




---------------------------------------------
---------------------------------------------
get_trace_time_scale: Automatically estimate a reasonable time trace bin width from data.
(Called by 03_batch_processing.py)
2024-07-31, 13:00:04
2 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
min_avg_counts (criterion 1: minimum average counts per bin): 10.0
min_bin_width (criterion 2: minimum absolute bin width) [s]: 0.0001
use_tau_diff (whether to use diffusion time estimate as criterion 3): False
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False


Used only count rate and absolute minimum bin width as criteria, ignoring diffusion kinetics.

1. time_for_min_avg_counts [ns]: {time_for_min_avg_counts}
2. min_bin_width [ns]: {min_bin_width_ns}

Settled for time_trace_sampling [ns]: {time_trace_sampling}




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by get_time_trace)
2024-07-31, 13:00:04
2 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 1835553




---------------------------------------------
---------------------------------------------
get_time_trace: Bin photons into time trace, applying filters.
(Called by 03_batch_processing.py)
2024-07-31, 13:00:05
3 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
time_trace_sampling (time trace bin width) [s]: 0.00032687726615101957
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Split 60.0 s long acquisition into 183555 bins with an average of 10.000005447958378 counts per bin.
Wrote results to ../test_data/2ch_setup/20240731_1300_LLPS_dense_AF647_bleaching/02_Trace_ch0.csv/png



---------------------------------------------
---------------------------------------------
get_auto_threshold: Estimate a reasonable threshold photon count value from data using statistical criteria.
(Called by threshold_trace)
2024-07-31, 13:00:05
3 output files generated so far.

Parameters used:
time_trace: pre-binned photon time trace of length 183555 and an average of 10.000005447958378 counts per bin
threshold_alpha (approx. false-positive thresholding rate to be allowed by threshold): 0.02

Approximated the photon count distribution as a Gaussian with mean 9.0 and standard deviation 5.0.
Based on that, settled for a threshold of 34.




---------------------------------------------
---------------------------------------------
threshold_trace: Apply threshold to a pre-binned time trace to detect bursts.
(Called by run_burst_removal)
2024-07-31, 13:00:05
3 output files generated so far.

Parameters used:
time_trace: pre-binned photon time trace of length 183555 and an average of 10.000005447958378 counts per bin
threshold_alpha (approx. false-positive thresholding rate to be allowed in case of auto-thresholding): 0.02
-> Auto-thresholding used: True
threshold_counts (actual threshold used): 34

Thresholded the time trace, identifying 843 bins as bursts. 




---------------------------------------------
---------------------------------------------
update_photons_from_bursts: Use thresholded (re-binned) time trace to update photon information.
(Called by run_burst_removal)
2024-07-31, 13:00:12
3 output files generated so far.

Parameters used:
  burst_bins: thresholded, binary, time trace with 183555 bins of which 843 are labelled as burst bins
  time_trace_sampling (time trace bin width) [s]: 0.00032687726615101957
  update_weights (whether to label the burst photons as photons to exclude from processed by setting their weights to 0): True
  update_macro_times (whether to update the macro time labled to close gaps in the photon stream created by discarding burst photons): True
  
  Out of 3661615 photons included in burst annotation, 76196 were actually labelled as burst photons.
  



---------------------------------------------
---------------------------------------------
run_burst_removal: Use one or multiple time traces for burst removal.
(Called by 03_batch_processing.py)
2024-07-31, 13:00:12
4 output files generated so far.

Parameters used:
  time_trace: 1 pre-binned photon time traces of length 183555 and averages of 10.000005447958378 counts per bin
  time_trace_sampling (time trace bin width) [s]: 0.00032687726615101957
  threshold_alpha (approx. false-positive thresholding rate to be allowed in case of auto-thresholding): 0.02
  threshold_counts (actual threshold used): None
  update_weights (whether to label the burst photons as photons to exclude from processed by setting their weights to 0): True
  update_macro_times (whether to update the macro time labled to close gaps in the photon stream created by discarding burst photons): True
  
  Burst detection on a single trace.
  Overall detected 843 burst bins in 183555 bins.  
  Out of 3661615 photons included in burst annotation, 76196 were actually labelled as burst photons.
  Wrote results to ../test_data/2ch_setup/20240731_1300_LLPS_dense_AF647_bleaching/03_Burst_annotation_single_trace.csv/png



---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2024-07-31, 13:00:13
4 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 1794836




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2024-07-31, 13:00:13
4 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 1794836




---------------------------------------------
---------------------------------------------
afterpulse_correlation: Created afterpulsing prediction using biexponential model
(Called by correlation_apply_filters)
2024-07-31, 13:00:14
4 output files generated so far.

Expression:
  (A1 * exp(-t/tau1) + A2 * exp(-t/tau2)) * micro_time_gate_correction / (1 + (A1 * tau1 + A2 * tau2)) / count_rate
  Parameters used:
  channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
  A1 [GHz]: 1.3747e-07
  tau1 [ns]: 6774.349999999999
  A2 [GHz]: 7.346930000000001e-06
  tau2 [ns]: 313.849
  count rate [GHz]: 3.0052339627539836e-05
  amplitude correction factor for afterpulses discarded by micro time gating: 1.0
  



---------------------------------------------
---------------------------------------------
correlation_apply_filters: Calculate correlation function applying various filters
(Called by get_correlation_uncertainty)
2024-07-31, 13:00:14
4 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((0,), ((), (0,)))
ext_indices specified: False
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
-> Actual shortest and longest lag times calculated [ns]: 1022.5286308016623, 939550401.9112535.
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Average count rates (considering corrections and weights) [GHz]:
First correlation channel: 3.0052339627539836e-05
Second correlation channel: 3.0052339627539836e-05

Calculated as auto-correlation function.




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2024-07-31, 13:00:14
4 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: True
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 319878




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2024-07-31, 13:00:14
4 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: True
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 319878




---------------------------------------------
---------------------------------------------
afterpulse_correlation: Created afterpulsing prediction using biexponential model
(Called by correlation_apply_filters)
2024-07-31, 13:00:14
4 output files generated so far.

Expression:
  (A1 * exp(-t/tau1) + A2 * exp(-t/tau2)) * micro_time_gate_correction / (1 + (A1 * tau1 + A2 * tau2)) / count_rate
  Parameters used:
  channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
  A1 [GHz]: 1.3747e-07
  tau1 [ns]: 6774.349999999999
  A2 [GHz]: 7.346930000000001e-06
  tau2 [ns]: 313.849
  count rate [GHz]: 5.355973966878057e-05
  amplitude correction factor for afterpulses discarded by micro time gating: 1.0
  



---------------------------------------------
---------------------------------------------
correlation_apply_filters: Calculate correlation function applying various filters
(Called by get_segment_ccs)
2024-07-31, 13:00:14
4 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((0,), ((), (0,)))
ext_indices specified: True
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
-> Actual shortest and longest lag times calculated [ns]: 1022.5286308016623, 939550401.9112535.
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Average count rates (considering corrections and weights) [GHz]:
First correlation channel: 5.355973966878057e-05
Second correlation channel: 5.355973966878057e-05

Calculated as auto-correlation function.




---------------------------------------------
---------------------------------------------
get_segment_ccs: Calculate correlation functions with filters for evenly spaces time segments of the measurement.
(Called by get_Wohland_SD)
2024-07-31, 13:00:16
5 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((0,), ((), (0,)))
minimum_window_length (shortest allowed window length) [s]: 5.972367996303897
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Split time trace of length 60.0 s into 10 segments, of which 10 were usable.
Wrote results to ../test_data/2ch_setup/20240731_1300_LLPS_dense_AF647_bleaching/04_segment_ACFs_ch0_br.csv/png



---------------------------------------------
---------------------------------------------
get_Wohland_SD: Calculate correlation functions uncertainty using Wohland method.
(Called by get_correlation_uncertainty)
2024-07-31, 13:00:16
5 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((0,), ((), (0,)))
minimum_window_length (shortest allowed window length) [s]: 5.9723679963038965
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

  
Used 10 segments for uncertainty estimation.




---------------------------------------------
---------------------------------------------
get_correlation_uncertainty: Calculate correlation function and uncertainty.
(Called by 03_batch_processing.py)
2024-07-31, 13:00:17
6 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((0,), ((), (0,)))
default_uncertainty_method (whether to try Wohland method SD calculation or directly use bootstrap): Wohland
minimum_window_length (shortest allowed window length) [s]: []
n_bootstrap_reps (number of bootstrap replicates to perform) 10
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: None, None
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Results written to ../test_data/2ch_setup/20240731_1300_LLPS_dense_AF647_bleaching/05_ACF_ch0_br.csv/png



---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by get_trace_time_scale)
2024-07-31, 13:00:17
6 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 1794836




---------------------------------------------
---------------------------------------------
get_trace_time_scale: Automatically estimate a reasonable time trace bin width from data.
(Called by 03_batch_processing.py)
2024-07-31, 13:00:17
6 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
min_avg_counts (criterion 1: minimum average counts per bin): 10.0
min_bin_width (criterion 2: minimum absolute bin width) [s]: 0.0001
use_tau_diff (whether to use diffusion time estimate as criterion 3): False
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False


Used only count rate and absolute minimum bin width as criteria, ignoring diffusion kinetics.

1. time_for_min_avg_counts [ns]: {time_for_min_avg_counts}
2. min_bin_width [ns]: {min_bin_width_ns}

Settled for time_trace_sampling [ns]: {time_trace_sampling}




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by get_time_trace)
2024-07-31, 13:00:17
6 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 1794836




---------------------------------------------
---------------------------------------------
get_time_trace: Bin photons into time trace, applying filters.
(Called by 03_batch_processing.py)
2024-07-31, 13:00:19
7 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
time_trace_sampling (time trace bin width) [s]: 0.00033275285297954227
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Split 60.0 s long acquisition into 179483 bins with an average of 10.000022286233236 counts per bin.
Wrote results to ../test_data/2ch_setup/20240731_1300_LLPS_dense_AF647_bleaching/06_Trace_ch0_br.csv/png



---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by polynomial_undrifting_rss)
2024-07-31, 13:03:41
7 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 1794836




---------------------------------------------
---------------------------------------------
polynomial_undrifting_rss: Fit time trace with a polynomial model to describe bleaching/drift trend, and correct it.
(Called by 03_batch_processing.py)
2024-07-31, 13:03:44
8 output files generated so far.

Parameters used:
time_trace: pre-binned photon time trace of length 179483 and an average of 10.000022286233236 counts per bin
time_trace_bin_centers: bin centers [ns] for time trace, binwidth is 332752.85297954234 ns.
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
undrift_order (polynomial fit order used to describe the beaching/drift trend): 10
-> Auto-tuned undrift fit order based on residual sum of squares.
max_undrift_order (in case of auto-tuning of undrift-order, what was the maximum allowed order): 10
update_undrift_weights (whether to write the results of undrifting into the photon weights for further processing): True
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Corrected 1794836 photons with bleaching/drift trend model model b(t[ns]):  
b(t[ns]) = 26.668612241879682 + (-7.201380072001804e-09)*t^1 + (1.6165435523770467e-18)*t^2 + (-2.095903606368422e-28)*t^3 + (1.641479755051476e-38)*t^4 + (-8.134256129271353e-49)*t^5 + (2.6089502956647426e-59)*t^6 + (-5.3984939773324046e-70)*t^7 + (6.950735580102403e-81)*t^8 + (-5.0601017426258833e-92)*t^9 + (1.5898619969565128e-103)*t^10
Wrote results to ../test_data/2ch_setup/20240731_1300_LLPS_dense_AF647_bleaching/07_Trace_ch0_br_undrift_fit.csv/png



---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2024-07-31, 13:03:44
8 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 1794836




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2024-07-31, 13:03:44
8 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 1794836




---------------------------------------------
---------------------------------------------
afterpulse_correlation: Created afterpulsing prediction using biexponential model
(Called by correlation_apply_filters)
2024-07-31, 13:03:45
8 output files generated so far.

Expression:
  (A1 * exp(-t/tau1) + A2 * exp(-t/tau2)) * micro_time_gate_correction / (1 + (A1 * tau1 + A2 * tau2)) / count_rate
  Parameters used:
  channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
  A1 [GHz]: 1.3747e-07
  tau1 [ns]: 6774.349999999999
  A2 [GHz]: 7.346930000000001e-06
  tau2 [ns]: 313.849
  count rate [GHz]: 6.504552578642994e-05
  amplitude correction factor for afterpulses discarded by micro time gating: 1.0
  



---------------------------------------------
---------------------------------------------
correlation_apply_filters: Calculate correlation function applying various filters
(Called by get_correlation_uncertainty)
2024-07-31, 13:03:45
8 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((0,), ((), (0,)))
ext_indices specified: False
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
-> Actual shortest and longest lag times calculated [ns]: 1022.5286308016623, 939550401.9112535.
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Average count rates (considering corrections and weights) [GHz]:
First correlation channel: 6.504552578642994e-05
Second correlation channel: 6.504552578642994e-05

Calculated as auto-correlation function.




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2024-07-31, 13:03:46
8 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: True
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 319878




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2024-07-31, 13:03:46
8 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: True
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 319878




---------------------------------------------
---------------------------------------------
afterpulse_correlation: Created afterpulsing prediction using biexponential model
(Called by correlation_apply_filters)
2024-07-31, 13:03:46
8 output files generated so far.

Expression:
  (A1 * exp(-t/tau1) + A2 * exp(-t/tau2)) * micro_time_gate_correction / (1 + (A1 * tau1 + A2 * tau2)) / count_rate
  Parameters used:
  channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
  A1 [GHz]: 1.3747e-07
  tau1 [ns]: 6774.349999999999
  A2 [GHz]: 7.346930000000001e-06
  tau2 [ns]: 313.849
  count rate [GHz]: 7.844717216122015e-05
  amplitude correction factor for afterpulses discarded by micro time gating: 1.0
  



---------------------------------------------
---------------------------------------------
correlation_apply_filters: Calculate correlation function applying various filters
(Called by get_segment_ccs)
2024-07-31, 13:03:46
8 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((0,), ((), (0,)))
ext_indices specified: True
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
-> Actual shortest and longest lag times calculated [ns]: 1022.5286308016623, 939550401.9112535.
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Average count rates (considering corrections and weights) [GHz]:
First correlation channel: 7.844717216122015e-05
Second correlation channel: 7.844717216122015e-05

Calculated as auto-correlation function.




---------------------------------------------
---------------------------------------------
get_segment_ccs: Calculate correlation functions with filters for evenly spaces time segments of the measurement.
(Called by get_Wohland_SD)
2024-07-31, 13:03:49
9 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((0,), ((), (0,)))
minimum_window_length (shortest allowed window length) [s]: 5.972367996303897
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Split time trace of length 60.0 s into 10 segments, of which 10 were usable.
Wrote results to ../test_data/2ch_setup/20240731_1300_LLPS_dense_AF647_bleaching/08_segment_ACFs_ch0_br_dt.csv/png



---------------------------------------------
---------------------------------------------
get_Wohland_SD: Calculate correlation functions uncertainty using Wohland method.
(Called by get_correlation_uncertainty)
2024-07-31, 13:03:49
9 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((0,), ((), (0,)))
minimum_window_length (shortest allowed window length) [s]: 5.9723679963038965
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

  
Used 10 segments for uncertainty estimation.




---------------------------------------------
---------------------------------------------
get_correlation_uncertainty: Calculate correlation function and uncertainty.
(Called by 03_batch_processing.py)
2024-07-31, 13:03:50
10 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((0,), ((), (0,)))
default_uncertainty_method (whether to try Wohland method SD calculation or directly use bootstrap): Wohland
minimum_window_length (shortest allowed window length) [s]: []
n_bootstrap_reps (number of bootstrap replicates to perform) 10
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: None, None
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Results written to ../test_data/2ch_setup/20240731_1300_LLPS_dense_AF647_bleaching/09_ACF_ch0_br_dt.csv/png



---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2024-07-31, 13:03:50
10 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: True
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 319878




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2024-07-31, 13:03:50
10 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: True
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 319878




---------------------------------------------
---------------------------------------------
afterpulse_correlation: Created afterpulsing prediction using biexponential model
(Called by correlation_apply_filters)
2024-07-31, 13:03:50
10 output files generated so far.

Expression:
  (A1 * exp(-t/tau1) + A2 * exp(-t/tau2)) * micro_time_gate_correction / (1 + (A1 * tau1 + A2 * tau2)) / count_rate
  Parameters used:
  channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
  A1 [GHz]: 1.3747e-07
  tau1 [ns]: 6774.349999999999
  A2 [GHz]: 7.346930000000001e-06
  tau2 [ns]: 313.849
  count rate [GHz]: 7.844717216122015e-05
  amplitude correction factor for afterpulses discarded by micro time gating: 1.0
  



---------------------------------------------
---------------------------------------------
correlation_apply_filters: Calculate correlation function applying various filters
(Called by get_segment_ccs)
2024-07-31, 13:03:50
10 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((0,), ((), (0,)))
ext_indices specified: True
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 100000.0, 1000000000.0
-> Actual shortest and longest lag times calculated [ns]: 114689.71131191673, 939550401.9112535.
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Average count rates (considering corrections and weights) [GHz]:
First correlation channel: 7.844717216122015e-05
Second correlation channel: 7.844717216122015e-05

Calculated as auto-correlation function.




---------------------------------------------
---------------------------------------------
get_segment_ccs: Calculate correlation functions with filters for evenly spaces time segments of the measurement.
(Called by run_mse_filter)
2024-07-31, 13:03:53
11 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((0,), ((), (0,)))
minimum_window_length (shortest allowed window length) [s]: 5.972367996303897
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 100000.0, 1000000000.0
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Split time trace of length 60.0 s into 10 segments, of which 10 were usable.
Wrote results to ../test_data/2ch_setup/20240731_1300_LLPS_dense_AF647_bleaching/10_segment_ACFs_ch0_br_dt.csv/png



---------------------------------------------
---------------------------------------------
cc_mse_filter_get_mse: Iteratively compare correlation functions to flag potential outliers through mean-square error statistics.
(Called by run_mse_filter)
2024-07-31, 13:03:53
11 output files generated so far.

Parameters used:
  segment_ccs: Set of 10 correlation functions to compare, each containing 79 data points
  ignore_amplitude_fluctuations (whether to linearly scale data to emphasise correlation function shape anomalies over amplitude fluctuations): True
  
  Found mean-square error values varying over a factor of 11.0. 
  



---------------------------------------------
---------------------------------------------
run_mse_filter: Segment photon stream into time windows, correlate them, and remove outliers with anomalous correlation function.
(Called by 03_batch_processing.py)
2024-07-31, 13:03:54
12 output files generated so far.

Parameters_used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((0,), ((), (0,)))
minimum_window_length (shortest allowed window length) [s]: Automatically chosen as 5.9723679963038965
mse_fold_threshold (mean-square error fold-change threshold for discarding segments): 2.5
ignore_amplitude_fluctuations (whether to linearly scale data to emphasise correlation function shape anomalies over amplitude fluctuations): True
update_macro_times (whether to update the macro time labled to close gaps in the photon stream created by discarding burst photons): True
update_weights (whether to label the burst photons as photons to exclude from processed by setting their weights to 0): True
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 100000.0, 1000000000.0
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True

Out of 3661615 photons, 685872 were discarded.

  Split data into 10 segments, of which 10 were worth looking at, and 9 were kept in the end.
  Wrote results to ../test_data/2ch_setup/20240731_1300_LLPS_dense_AF647_bleaching/11_anom_ACF_rem_ch0_br_dt.csv/png



---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2024-07-31, 13:03:54
12 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

overall number of photons selected: 1474958




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2024-07-31, 13:03:54
12 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

overall number of photons selected: 1474958




---------------------------------------------
---------------------------------------------
afterpulse_correlation: Created afterpulsing prediction using biexponential model
(Called by correlation_apply_filters)
2024-07-31, 13:03:55
12 output files generated so far.

Expression:
  (A1 * exp(-t/tau1) + A2 * exp(-t/tau2)) * micro_time_gate_correction / (1 + (A1 * tau1 + A2 * tau2)) / count_rate
  Parameters used:
  channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
  A1 [GHz]: 1.3747e-07
  tau1 [ns]: 6774.349999999999
  A2 [GHz]: 7.346930000000001e-06
  tau2 [ns]: 313.849
  count rate [GHz]: 6.355649143097962e-05
  amplitude correction factor for afterpulses discarded by micro time gating: 1.0
  



---------------------------------------------
---------------------------------------------
correlation_apply_filters: Calculate correlation function applying various filters
(Called by get_correlation_uncertainty)
2024-07-31, 13:03:55
12 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((0,), ((), (0,)))
ext_indices specified: False
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
-> Actual shortest and longest lag times calculated [ns]: 1022.5286308016623, 939550401.9112535.
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

Average count rates (considering corrections and weights) [GHz]:
First correlation channel: 6.355649143097962e-05
Second correlation channel: 6.355649143097962e-05

Calculated as auto-correlation function.




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2024-07-31, 13:03:55
12 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: True
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

overall number of photons selected: 0




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2024-07-31, 13:03:55
12 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: True
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

overall number of photons selected: 0




---------------------------------------------
---------------------------------------------
get_segment_ccs: Calculate correlation functions with filters for evenly spaces time segments of the measurement.
(Called by get_Wohland_SD)
2024-07-31, 13:03:58
13 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((0,), ((), (0,)))
minimum_window_length (shortest allowed window length) [s]: 5.375131038669083
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

Split time trace of length 60.0 s into 12 segments, of which 10 were usable.
Wrote results to ../test_data/2ch_setup/20240731_1300_LLPS_dense_AF647_bleaching/12_segment_ACFs_ch0_br_dt_ar.csv/png



---------------------------------------------
---------------------------------------------
get_Wohland_SD: Calculate correlation functions uncertainty using Wohland method.
(Called by get_correlation_uncertainty)
2024-07-31, 13:03:58
13 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((0,), ((), (0,)))
minimum_window_length (shortest allowed window length) [s]: 5.375131038669083
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

  
Used 10 segments for uncertainty estimation.




---------------------------------------------
---------------------------------------------
get_correlation_uncertainty: Calculate correlation function and uncertainty.
(Called by 03_batch_processing.py)
2024-07-31, 13:03:59
14 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((0,), ((), (0,)))
default_uncertainty_method (whether to try Wohland method SD calculation or directly use bootstrap): Wohland
minimum_window_length (shortest allowed window length) [s]: []
n_bootstrap_reps (number of bootstrap replicates to perform) 10
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: None, None
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

Results written to ../test_data/2ch_setup/20240731_1300_LLPS_dense_AF647_bleaching/13_ACF_ch0_br_dt_ar.csv/png



---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by get_tcspc_histogram)
2024-07-31, 13:03:59
14 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

overall number of photons selected: 1474958




---------------------------------------------
---------------------------------------------
get_tcspc_histogram: Calculate a TCSPC histogram.
(Called by 03_batch_processing.py)
2024-07-31, 13:03:59
15 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))  
micro_times (time tags to histogram): from loaded TTTR retrieved  1474958 photon time tags, of which 231.61627658423157 % were ultimately used.
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

Calculated TCSPC histogram:
has 200 bins at 250.0 ps resolution
contains 3416242.80078125 photons
ranges over 49.74999859297391 ns

Wrote results to ../test_data/2ch_setup/20240731_1300_LLPS_dense_AF647_bleaching/14_TCSPC_ch0_br_dt_ar.csv/png



---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by get_tcspc_histogram)
2024-07-31, 13:03:59
15 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

overall number of photons selected: 1474958




---------------------------------------------
---------------------------------------------
get_tcspc_histogram: Calculate a TCSPC histogram.
(Called by get_background_tail_fit)
2024-07-31, 13:04:00
16 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))  
micro_times (time tags to histogram): from loaded TTTR retrieved  1474958 photon time tags, of which 231.61627658423157 % were ultimately used.
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

Calculated TCSPC histogram:
has 200 bins at 250.0 ps resolution
contains 3416242.80078125 photons
ranges over 49.74999859297391 ns

Wrote results to ../test_data/2ch_setup/20240731_1300_LLPS_dense_AF647_bleaching/15_TCSPC_ch0_br_dt_ar.csv/png



---------------------------------------------
---------------------------------------------
Error: Logging traceback.
(Called by 03_batch_processing.py)
2024-07-31, 13:04:00
16 output files generated so far.

Traceback (most recent call last):
  File "03_batch_processing.py", line 268, in <module>
calling_function = script_name)
  File "/fs/gpfs41/lv02/fileset02/pool/pool-schwille-spt/_Software/FCS_cleaner_dev/FCS_Fixer/functions/FCS_Fixer.py", line 6750, in get_background_tail_fit
'y_0': np.min(tcspc_y_crop),
  File "<__array_function__ internals>", line 6, in amin
  File "/fs/home/krohn/.conda/envs/tttr/lib/python3.7/site-packages/numpy/core/fromnumeric.py", line 2859, in amin
keepdims=keepdims, initial=initial, where=where)
  File "/fs/home/krohn/.conda/envs/tttr/lib/python3.7/site-packages/numpy/core/fromnumeric.py", line 87, in _wrapreduction
return ufunc.reduce(obj, axis, dtype, out, **passkwargs)
ValueError: zero-size array to reduction operation minimum which has no identity




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2024-07-31, 13:04:00
16 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 1835553




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2024-07-31, 13:04:00
16 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 1826062




---------------------------------------------
---------------------------------------------
correlation_apply_filters: Calculate correlation function applying various filters
(Called by get_correlation_uncertainty)
2024-07-31, 13:04:03
16 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((1,), ((), (0,)))
ext_indices specified: False
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
-> Actual shortest and longest lag times calculated [ns]: 1022.5286308016623, 939550401.9112535.
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Average count rates (considering corrections and weights) [GHz]:
First correlation channel: 3.059252404661541e-05
Second correlation channel: 3.0434344550423708e-05

Calculated as two-channel cross-correlation function with assumption of time symmetry.




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2024-07-31, 13:04:03
16 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: True
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 337548




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2024-07-31, 13:04:03
16 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: True
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 337106




---------------------------------------------
---------------------------------------------
correlation_apply_filters: Calculate correlation function applying various filters
(Called by get_segment_ccs)
2024-07-31, 13:04:04
16 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((1,), ((), (0,)))
ext_indices specified: True
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
-> Actual shortest and longest lag times calculated [ns]: 1022.5286308016623, 939550401.9112535.
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Average count rates (considering corrections and weights) [GHz]:
First correlation channel: 5.625832724509967e-05
Second correlation channel: 5.6184338951924555e-05

Calculated as two-channel cross-correlation function with assumption of time symmetry.




---------------------------------------------
---------------------------------------------
get_segment_ccs: Calculate correlation functions with filters for evenly spaces time segments of the measurement.
(Called by get_Wohland_SD)
2024-07-31, 13:04:07
17 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((1,), ((), (0,)))
minimum_window_length (shortest allowed window length) [s]: 6.000005465153025
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Split time trace of length 60.0 s into 10 segments, of which 10 were usable.
Wrote results to ../test_data/2ch_setup/20240731_1300_LLPS_dense_AF647_bleaching/16_segment_CCFs_symm_ch0_ch1.csv/png



---------------------------------------------
---------------------------------------------
get_Wohland_SD: Calculate correlation functions uncertainty using Wohland method.
(Called by get_correlation_uncertainty)
2024-07-31, 13:04:07
17 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((1,), ((), (0,)))
minimum_window_length (shortest allowed window length) [s]: 6.000005465153024
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

  
Used 10 segments for uncertainty estimation.




---------------------------------------------
---------------------------------------------
get_correlation_uncertainty: Calculate correlation function and uncertainty.
(Called by 03_batch_processing.py)
2024-07-31, 13:04:07
18 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((1,), ((), (0,)))
default_uncertainty_method (whether to try Wohland method SD calculation or directly use bootstrap): Wohland
minimum_window_length (shortest allowed window length) [s]: []
n_bootstrap_reps (number of bootstrap replicates to perform) 10
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: None, None
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Results written to ../test_data/2ch_setup/20240731_1300_LLPS_dense_AF647_bleaching/17_CCF_symm_ch0_ch1.csv/png



---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by get_trace_time_scale)
2024-07-31, 13:04:07
18 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 1835553




---------------------------------------------
---------------------------------------------
get_trace_time_scale: Automatically estimate a reasonable time trace bin width from data.
(Called by 03_batch_processing.py)
2024-07-31, 13:04:07
18 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
min_avg_counts (criterion 1: minimum average counts per bin): 10.0
min_bin_width (criterion 2: minimum absolute bin width) [s]: 0.0001
use_tau_diff (whether to use diffusion time estimate as criterion 3): False
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False


Used only count rate and absolute minimum bin width as criteria, ignoring diffusion kinetics.

1. time_for_min_avg_counts [ns]: {time_for_min_avg_counts}
2. min_bin_width [ns]: {min_bin_width_ns}

Settled for time_trace_sampling [ns]: {time_trace_sampling}




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by get_trace_time_scale)
2024-07-31, 13:04:07
18 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 1826062




---------------------------------------------
---------------------------------------------
get_trace_time_scale: Automatically estimate a reasonable time trace bin width from data.
(Called by 03_batch_processing.py)
2024-07-31, 13:04:07
18 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
min_avg_counts (criterion 1: minimum average counts per bin): 10.0
min_bin_width (criterion 2: minimum absolute bin width) [s]: 0.0001
use_tau_diff (whether to use diffusion time estimate as criterion 3): False
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False


Used only count rate and absolute minimum bin width as criteria, ignoring diffusion kinetics.

1. time_for_min_avg_counts [ns]: {time_for_min_avg_counts}
2. min_bin_width [ns]: {min_bin_width_ns}

Settled for time_trace_sampling [ns]: {time_trace_sampling}




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by get_time_trace)
2024-07-31, 13:04:07
18 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 1835553




---------------------------------------------
---------------------------------------------
get_time_trace: Bin photons into time trace, applying filters.
(Called by 03_batch_processing.py)
2024-07-31, 13:04:08
19 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
time_trace_sampling (time trace bin width) [s]: 0.00032772564133934655
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Split 60.0 s long acquisition into 183080 bins with an average of 10.025955866287962 counts per bin.
Wrote results to ../test_data/2ch_setup/20240731_1300_LLPS_dense_AF647_bleaching/18_Trace_ch0.csv/png



---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by get_time_trace)
2024-07-31, 13:04:08
19 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 1826062




---------------------------------------------
---------------------------------------------
get_time_trace: Bin photons into time trace, applying filters.
(Called by 03_batch_processing.py)
2024-07-31, 13:04:09
20 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
time_trace_sampling (time trace bin width) [s]: 0.00032772564133934655
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Split 60.0 s long acquisition into 183080 bins with an average of 9.974104216735853 counts per bin.
Wrote results to ../test_data/2ch_setup/20240731_1300_LLPS_dense_AF647_bleaching/19_Trace_ch1.csv/png



---------------------------------------------
---------------------------------------------
get_auto_threshold: Estimate a reasonable threshold photon count value from data using statistical criteria.
(Called by threshold_trace)
2024-07-31, 13:04:09
20 output files generated so far.

Parameters used:
time_trace: pre-binned photon time trace of length 183080 and an average of 10.025955866287962 counts per bin
threshold_alpha (approx. false-positive thresholding rate to be allowed by threshold): 0.02

Approximated the photon count distribution as a Gaussian with mean 9.0 and standard deviation 5.0.
Based on that, settled for a threshold of 34.




---------------------------------------------
---------------------------------------------
threshold_trace: Apply threshold to a pre-binned time trace to detect bursts.
(Called by run_burst_removal)
2024-07-31, 13:04:09
20 output files generated so far.

Parameters used:
time_trace: pre-binned photon time trace of length 183080 and an average of 10.025955866287962 counts per bin
threshold_alpha (approx. false-positive thresholding rate to be allowed in case of auto-thresholding): 0.02
-> Auto-thresholding used: True
threshold_counts (actual threshold used): 34

Thresholded the time trace, identifying 853 bins as bursts. 




---------------------------------------------
---------------------------------------------
get_auto_threshold: Estimate a reasonable threshold photon count value from data using statistical criteria.
(Called by threshold_trace)
2024-07-31, 13:04:09
20 output files generated so far.

Parameters used:
time_trace: pre-binned photon time trace of length 183080 and an average of 9.974104216735853 counts per bin
threshold_alpha (approx. false-positive thresholding rate to be allowed by threshold): 0.02

Approximated the photon count distribution as a Gaussian with mean 9.0 and standard deviation 5.0.
Based on that, settled for a threshold of 34.




---------------------------------------------
---------------------------------------------
threshold_trace: Apply threshold to a pre-binned time trace to detect bursts.
(Called by run_burst_removal)
2024-07-31, 13:04:09
20 output files generated so far.

Parameters used:
time_trace: pre-binned photon time trace of length 183080 and an average of 9.974104216735853 counts per bin
threshold_alpha (approx. false-positive thresholding rate to be allowed in case of auto-thresholding): 0.02
-> Auto-thresholding used: True
threshold_counts (actual threshold used): 34

Thresholded the time trace, identifying 795 bins as bursts. 




---------------------------------------------
---------------------------------------------
update_photons_from_bursts: Use thresholded (re-binned) time trace to update photon information.
(Called by run_burst_removal)
2024-07-31, 13:04:15
20 output files generated so far.

Parameters used:
  burst_bins: thresholded, binary, time trace with 183080 bins of which 1191 are labelled as burst bins
  time_trace_sampling (time trace bin width) [s]: 0.00032772564133934655
  update_weights (whether to label the burst photons as photons to exclude from processed by setting their weights to 0): True
  update_macro_times (whether to update the macro time labled to close gaps in the photon stream created by discarding burst photons): True
  
  Out of 3661615 photons included in burst annotation, 98770 were actually labelled as burst photons.
  



---------------------------------------------
---------------------------------------------
run_burst_removal: Use one or multiple time traces for burst removal.
(Called by 03_batch_processing.py)
2024-07-31, 13:04:16
21 output files generated so far.

Parameters used:
  time_trace: 2 pre-binned photon time traces of length 183080 and averages of [10.02595587  9.97410422] counts per bin
  time_trace_sampling (time trace bin width) [s]: 0.00032772564133934655
  threshold_alpha (approx. false-positive thresholding rate to be allowed in case of auto-thresholding): 0.02
  threshold_counts (actual threshold used): None
  update_weights (whether to label the burst photons as photons to exclude from processed by setting their weights to 0): True
  update_macro_times (whether to update the macro time labled to close gaps in the photon stream created by discarding burst photons): True
  
  Joint burst detection in 2 traces via logical OR.
  Overall detected 1191 burst bins in 183080 bins.  
  Out of 3661615 photons included in burst annotation, 98770 were actually labelled as burst photons.
  Wrote results to ../test_data/2ch_setup/20240731_1300_LLPS_dense_AF647_bleaching/20_Burst_annotationOR_of_2_traces.csv/png



---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2024-07-31, 13:04:16
21 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 1785292




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2024-07-31, 13:04:16
21 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 1777553




---------------------------------------------
---------------------------------------------
correlation_apply_filters: Calculate correlation function applying various filters
(Called by get_correlation_uncertainty)
2024-07-31, 13:04:19
21 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((1,), ((), (0,)))
ext_indices specified: False
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
-> Actual shortest and longest lag times calculated [ns]: 1022.5286308016623, 939550401.9112535.
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Average count rates (considering corrections and weights) [GHz]:
First correlation channel: 2.9950005450984102e-05
Second correlation channel: 2.9820179869361378e-05

Calculated as two-channel cross-correlation function with assumption of time symmetry.




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2024-07-31, 13:04:19
21 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: True
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 315614




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2024-07-31, 13:04:19
21 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: True
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 315452




---------------------------------------------
---------------------------------------------
correlation_apply_filters: Calculate correlation function applying various filters
(Called by get_segment_ccs)
2024-07-31, 13:04:20
21 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((1,), ((), (0,)))
ext_indices specified: True
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
-> Actual shortest and longest lag times calculated [ns]: 1022.5286308016623, 939550401.9112535.
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Average count rates (considering corrections and weights) [GHz]:
First correlation channel: 5.294735501889097e-05
Second correlation channel: 5.2920201007507034e-05

Calculated as two-channel cross-correlation function with assumption of time symmetry.




---------------------------------------------
---------------------------------------------
get_segment_ccs: Calculate correlation functions with filters for evenly spaces time segments of the measurement.
(Called by get_Wohland_SD)
2024-07-31, 13:04:23
22 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((1,), ((), (0,)))
minimum_window_length (shortest allowed window length) [s]: 5.960907470409173
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Split time trace of length 60.0 s into 10 segments, of which 10 were usable.
Wrote results to ../test_data/2ch_setup/20240731_1300_LLPS_dense_AF647_bleaching/21_segment_CCFs_symm_ch0_ch1_br.csv/png



---------------------------------------------
---------------------------------------------
get_Wohland_SD: Calculate correlation functions uncertainty using Wohland method.
(Called by get_correlation_uncertainty)
2024-07-31, 13:04:23
22 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((1,), ((), (0,)))
minimum_window_length (shortest allowed window length) [s]: 5.960907470409172
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

  
Used 10 segments for uncertainty estimation.




---------------------------------------------
---------------------------------------------
get_correlation_uncertainty: Calculate correlation function and uncertainty.
(Called by 03_batch_processing.py)
2024-07-31, 13:04:23
23 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((1,), ((), (0,)))
default_uncertainty_method (whether to try Wohland method SD calculation or directly use bootstrap): Wohland
minimum_window_length (shortest allowed window length) [s]: []
n_bootstrap_reps (number of bootstrap replicates to perform) 10
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: None, None
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Results written to ../test_data/2ch_setup/20240731_1300_LLPS_dense_AF647_bleaching/22_CCF_symm_ch0_ch1_br.csv/png



---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by get_trace_time_scale)
2024-07-31, 13:04:23
23 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 1785292




---------------------------------------------
---------------------------------------------
get_trace_time_scale: Automatically estimate a reasonable time trace bin width from data.
(Called by 03_batch_processing.py)
2024-07-31, 13:04:23
23 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
min_avg_counts (criterion 1: minimum average counts per bin): 10.0
min_bin_width (criterion 2: minimum absolute bin width) [s]: 0.0001
use_tau_diff (whether to use diffusion time estimate as criterion 3): False
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False


Used only count rate and absolute minimum bin width as criteria, ignoring diffusion kinetics.

1. time_for_min_avg_counts [ns]: {time_for_min_avg_counts}
2. min_bin_width [ns]: {min_bin_width_ns}

Settled for time_trace_sampling [ns]: {time_trace_sampling}




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by get_time_trace)
2024-07-31, 13:04:23
23 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 1785292




---------------------------------------------
---------------------------------------------
get_time_trace: Bin photons into time trace, applying filters.
(Called by 03_batch_processing.py)
2024-07-31, 13:04:26
24 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
time_trace_sampling (time trace bin width) [s]: 0.00033388977659728336
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Split 60.0 s long acquisition into 178529 bins with an average of 10.000005601330876 counts per bin.
Wrote results to ../test_data/2ch_setup/20240731_1300_LLPS_dense_AF647_bleaching/23_Trace_ch0_br.csv/png



---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by polynomial_undrifting_rss)
2024-07-31, 13:07:40
24 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 1785292




---------------------------------------------
---------------------------------------------
polynomial_undrifting_rss: Fit time trace with a polynomial model to describe bleaching/drift trend, and correct it.
(Called by 03_batch_processing.py)
2024-07-31, 13:07:44
25 output files generated so far.

Parameters used:
time_trace: pre-binned photon time trace of length 178529 and an average of 10.000005601330876 counts per bin
time_trace_bin_centers: bin centers [ns] for time trace, binwidth is 333889.77659728343 ns.
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
undrift_order (polynomial fit order used to describe the beaching/drift trend): 10
-> Auto-tuned undrift fit order based on residual sum of squares.
max_undrift_order (in case of auto-tuning of undrift-order, what was the maximum allowed order): 10
update_undrift_weights (whether to write the results of undrifting into the photon weights for further processing): True
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Corrected 1785292 photons with bleaching/drift trend model model b(t[ns]):  
b(t[ns]) = 26.32737106388732 + (-7.15826086678497e-09)*t^1 + (1.6476733100349096e-18)*t^2 + (-2.186493382222948e-28)*t^3 + (1.745990880793899e-38)*t^4 + (-8.790585024029539e-49)*t^5 + (2.856224911956992e-59)*t^6 + (-5.973514550526785e-70)*t^7 + (7.759990683742572e-81)*t^8 + (-5.6925000206518584e-92)*t^9 + (1.8005922766182886e-103)*t^10
Wrote results to ../test_data/2ch_setup/20240731_1300_LLPS_dense_AF647_bleaching/24_Trace_ch0_br_undrift_fit.csv/png



---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by get_trace_time_scale)
2024-07-31, 13:07:44
25 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 1777553




---------------------------------------------
---------------------------------------------
get_trace_time_scale: Automatically estimate a reasonable time trace bin width from data.
(Called by 03_batch_processing.py)
2024-07-31, 13:07:44
25 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
min_avg_counts (criterion 1: minimum average counts per bin): 10.0
min_bin_width (criterion 2: minimum absolute bin width) [s]: 0.0001
use_tau_diff (whether to use diffusion time estimate as criterion 3): False
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False


Used only count rate and absolute minimum bin width as criteria, ignoring diffusion kinetics.

1. time_for_min_avg_counts [ns]: {time_for_min_avg_counts}
2. min_bin_width [ns]: {min_bin_width_ns}

Settled for time_trace_sampling [ns]: {time_trace_sampling}




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by get_time_trace)
2024-07-31, 13:07:44
25 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 1777553




---------------------------------------------
---------------------------------------------
get_time_trace: Bin photons into time trace, applying filters.
(Called by 03_batch_processing.py)
2024-07-31, 13:07:46
26 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
time_trace_sampling (time trace bin width) [s]: 0.00033534344519736806
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Split 60.0 s long acquisition into 177755 bins with an average of 10.0 counts per bin.
Wrote results to ../test_data/2ch_setup/20240731_1300_LLPS_dense_AF647_bleaching/25_Trace_ch1_br.csv/png



---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by polynomial_undrifting_rss)
2024-07-31, 13:11:07
26 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 1777553




---------------------------------------------
---------------------------------------------
polynomial_undrifting_rss: Fit time trace with a polynomial model to describe bleaching/drift trend, and correct it.
(Called by 03_batch_processing.py)
2024-07-31, 13:11:11
27 output files generated so far.

Parameters used:
time_trace: pre-binned photon time trace of length 177755 and an average of 10.0 counts per bin
time_trace_bin_centers: bin centers [ns] for time trace, binwidth is 335343.4451973681 ns.
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
undrift_order (polynomial fit order used to describe the beaching/drift trend): 10
-> Auto-tuned undrift fit order based on residual sum of squares.
max_undrift_order (in case of auto-tuning of undrift-order, what was the maximum allowed order): 10
update_undrift_weights (whether to write the results of undrifting into the photon weights for further processing): True
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Corrected 1777553 photons with bleaching/drift trend model model b(t[ns]):  
b(t[ns]) = 26.293026728920864 + (-7.104929940665159e-09)*t^1 + (1.6393098020945958e-18)*t^2 + (-2.1807517855332057e-28)*t^3 + (1.7446755970700626e-38)*t^4 + (-8.799521871246075e-49)*t^5 + (2.8645547208792175e-59)*t^6 + (-6.00356533286317e-70)*t^7 + (7.817397605502878e-81)*t^8 + (-5.749637689756545e-92)*t^9 + (1.8239146403874784e-103)*t^10
Wrote results to ../test_data/2ch_setup/20240731_1300_LLPS_dense_AF647_bleaching/26_Trace_ch1_br_undrift_fit.csv/png



---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2024-07-31, 13:11:11
27 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 1785292




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2024-07-31, 13:11:11
27 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 1777553




---------------------------------------------
---------------------------------------------
correlation_apply_filters: Calculate correlation function applying various filters
(Called by get_correlation_uncertainty)
2024-07-31, 13:11:14
27 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((1,), ((), (0,)))
ext_indices specified: False
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
-> Actual shortest and longest lag times calculated [ns]: 1022.5286308016623, 939550401.9112535.
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Average count rates (considering corrections and weights) [GHz]:
First correlation channel: 6.434589781540681e-05
Second correlation channel: 6.393414299458208e-05

Calculated as two-channel cross-correlation function with assumption of time symmetry.




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2024-07-31, 13:11:14
27 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: True
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 315614




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2024-07-31, 13:11:14
27 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: True
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 315452




---------------------------------------------
---------------------------------------------
correlation_apply_filters: Calculate correlation function applying various filters
(Called by get_segment_ccs)
2024-07-31, 13:11:14
27 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((1,), ((), (0,)))
ext_indices specified: True
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
-> Actual shortest and longest lag times calculated [ns]: 1022.5286308016623, 939550401.9112535.
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Average count rates (considering corrections and weights) [GHz]:
First correlation channel: 7.728624789963515e-05
Second correlation channel: 7.700502277367338e-05

Calculated as two-channel cross-correlation function with assumption of time symmetry.




---------------------------------------------
---------------------------------------------
get_segment_ccs: Calculate correlation functions with filters for evenly spaces time segments of the measurement.
(Called by get_Wohland_SD)
2024-07-31, 13:11:19
28 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((1,), ((), (0,)))
minimum_window_length (shortest allowed window length) [s]: 5.960907470409173
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Split time trace of length 60.0 s into 10 segments, of which 10 were usable.
Wrote results to ../test_data/2ch_setup/20240731_1300_LLPS_dense_AF647_bleaching/27_segment_CCFs_symm_ch0_ch1_br_dt.csv/png



---------------------------------------------
---------------------------------------------
get_Wohland_SD: Calculate correlation functions uncertainty using Wohland method.
(Called by get_correlation_uncertainty)
2024-07-31, 13:11:19
28 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((1,), ((), (0,)))
minimum_window_length (shortest allowed window length) [s]: 5.960907470409172
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

  
Used 10 segments for uncertainty estimation.




---------------------------------------------
---------------------------------------------
get_correlation_uncertainty: Calculate correlation function and uncertainty.
(Called by 03_batch_processing.py)
2024-07-31, 13:11:19
29 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((1,), ((), (0,)))
default_uncertainty_method (whether to try Wohland method SD calculation or directly use bootstrap): Wohland
minimum_window_length (shortest allowed window length) [s]: []
n_bootstrap_reps (number of bootstrap replicates to perform) 10
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: None, None
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Results written to ../test_data/2ch_setup/20240731_1300_LLPS_dense_AF647_bleaching/28_CCF_symm_ch0_ch1_br_dt.csv/png



---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2024-07-31, 13:11:19
29 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: True
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 315614




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2024-07-31, 13:11:19
29 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: True
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 315452




---------------------------------------------
---------------------------------------------
correlation_apply_filters: Calculate correlation function applying various filters
(Called by get_segment_ccs)
2024-07-31, 13:11:20
29 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((1,), ((), (0,)))
ext_indices specified: True
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 100000.0, 1000000000.0
-> Actual shortest and longest lag times calculated [ns]: 114689.71131191673, 939550401.9112535.
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Average count rates (considering corrections and weights) [GHz]:
First correlation channel: 7.728624789963515e-05
Second correlation channel: 7.700502277367338e-05

Calculated as two-channel cross-correlation function with assumption of time symmetry.




---------------------------------------------
---------------------------------------------
get_segment_ccs: Calculate correlation functions with filters for evenly spaces time segments of the measurement.
(Called by run_mse_filter)
2024-07-31, 13:11:24
30 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((1,), ((), (0,)))
minimum_window_length (shortest allowed window length) [s]: 5.960907470409173
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 100000.0, 1000000000.0
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Split time trace of length 60.0 s into 10 segments, of which 10 were usable.
Wrote results to ../test_data/2ch_setup/20240731_1300_LLPS_dense_AF647_bleaching/29_segment_CCFs_symm_ch0_ch1_br_dt.csv/png



---------------------------------------------
---------------------------------------------
cc_mse_filter_get_mse: Iteratively compare correlation functions to flag potential outliers through mean-square error statistics.
(Called by run_mse_filter)
2024-07-31, 13:11:24
30 output files generated so far.

Parameters used:
  segment_ccs: Set of 10 correlation functions to compare, each containing 79 data points
  ignore_amplitude_fluctuations (whether to linearly scale data to emphasise correlation function shape anomalies over amplitude fluctuations): True
  
  Found mean-square error values varying over a factor of 18.899999618530273. 
  



---------------------------------------------
---------------------------------------------
run_mse_filter: Segment photon stream into time windows, correlate them, and remove outliers with anomalous correlation function.
(Called by 03_batch_processing.py)
2024-07-31, 13:11:24
31 output files generated so far.

Parameters_used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((1,), ((), (0,)))
minimum_window_length (shortest allowed window length) [s]: Automatically chosen as 5.960907470409172
mse_fold_threshold (mean-square error fold-change threshold for discarding segments): 2.5
ignore_amplitude_fluctuations (whether to linearly scale data to emphasise correlation function shape anomalies over amplitude fluctuations): True
update_macro_times (whether to update the macro time labled to close gaps in the photon stream created by discarding burst photons): True
update_weights (whether to label the burst photons as photons to exclude from processed by setting their weights to 0): True
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 100000.0, 1000000000.0
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True

Out of 3661615 photons, 1439604 were discarded.

  Split data into 10 segments, of which 10 were worth looking at, and 7 were kept in the end.
  Wrote results to ../test_data/2ch_setup/20240731_1300_LLPS_dense_AF647_bleaching/30_anom_CCF_rem_symm_ch0_ch1_br_dt.csv/png



---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2024-07-31, 13:11:24
31 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

overall number of photons selected: 1101674




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2024-07-31, 13:11:25
31 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

overall number of photons selected: 1094141




---------------------------------------------
---------------------------------------------
correlation_apply_filters: Calculate correlation function applying various filters
(Called by get_correlation_uncertainty)
2024-07-31, 13:11:26
31 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((1,), ((), (0,)))
ext_indices specified: False
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
-> Actual shortest and longest lag times calculated [ns]: 1022.5286308016623, 939550401.9112535.
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

Average count rates (considering corrections and weights) [GHz]:
First correlation channel: 6.214587585658249e-05
Second correlation channel: 6.169126753802223e-05

Calculated as two-channel cross-correlation function with assumption of time symmetry.




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2024-07-31, 13:11:26
31 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: True
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

overall number of photons selected: 0




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2024-07-31, 13:11:26
31 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: True
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

overall number of photons selected: 0




---------------------------------------------
---------------------------------------------
get_segment_ccs: Calculate correlation functions with filters for evenly spaces time segments of the measurement.
(Called by get_Wohland_SD)
2024-07-31, 13:11:31
32 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((1,), ((), (0,)))
minimum_window_length (shortest allowed window length) [s]: 5.0
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

Split time trace of length 60.0 s into 14 segments, of which 9 were usable.
Wrote results to ../test_data/2ch_setup/20240731_1300_LLPS_dense_AF647_bleaching/31_segment_CCFs_symm_ch0_ch1_br_dt_ar.csv/png



---------------------------------------------
---------------------------------------------
get_Wohland_SD: Calculate correlation functions uncertainty using Wohland method.
(Called by get_correlation_uncertainty)
2024-07-31, 13:11:31
32 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((1,), ((), (0,)))
minimum_window_length (shortest allowed window length) [s]: 5.0
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

  
Used 9 segments for uncertainty estimation.




---------------------------------------------
---------------------------------------------
get_correlation_uncertainty: Calculate correlation function and uncertainty.
(Called by 03_batch_processing.py)
2024-07-31, 13:11:31
33 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((1,), ((), (0,)))
default_uncertainty_method (whether to try Wohland method SD calculation or directly use bootstrap): Wohland
minimum_window_length (shortest allowed window length) [s]: []
n_bootstrap_reps (number of bootstrap replicates to perform) 10
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: None, None
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

Results written to ../test_data/2ch_setup/20240731_1300_LLPS_dense_AF647_bleaching/32_CCF_symm_ch0_ch1_br_dt_ar.csv/png



---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by get_tcspc_histogram)
2024-07-31, 13:11:31
33 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

overall number of photons selected: 1101674




---------------------------------------------
---------------------------------------------
get_tcspc_histogram: Calculate a TCSPC histogram.
(Called by 03_batch_processing.py)
2024-07-31, 13:11:31
34 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))  
micro_times (time tags to histogram): from loaded TTTR retrieved  1101674 photon time tags, of which 235.37990076635649 % were ultimately used.
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

Calculated TCSPC histogram:
has 200 bins at 250.0 ps resolution
contains 2593119.16796875 photons
ranges over 49.74999859297391 ns

Wrote results to ../test_data/2ch_setup/20240731_1300_LLPS_dense_AF647_bleaching/33_TCSPC_ch0_br_dt_ar.csv/png



---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by get_tcspc_histogram)
2024-07-31, 13:11:31
34 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

overall number of photons selected: 1101674




---------------------------------------------
---------------------------------------------
get_tcspc_histogram: Calculate a TCSPC histogram.
(Called by get_background_tail_fit)
2024-07-31, 13:11:32
35 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))  
micro_times (time tags to histogram): from loaded TTTR retrieved  1101674 photon time tags, of which 235.37990076635649 % were ultimately used.
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

Calculated TCSPC histogram:
has 200 bins at 250.0 ps resolution
contains 2593119.16796875 photons
ranges over 49.74999859297391 ns

Wrote results to ../test_data/2ch_setup/20240731_1300_LLPS_dense_AF647_bleaching/34_TCSPC_ch0_br_dt_ar.csv/png



---------------------------------------------
---------------------------------------------
Error: Logging traceback.
(Called by 03_batch_processing.py)
2024-07-31, 13:11:32
35 output files generated so far.

Traceback (most recent call last):
  File "03_batch_processing.py", line 268, in <module>
calling_function = script_name)
  File "/fs/gpfs41/lv02/fileset02/pool/pool-schwille-spt/_Software/FCS_cleaner_dev/FCS_Fixer/functions/FCS_Fixer.py", line 6750, in get_background_tail_fit
'y_0': np.min(tcspc_y_crop),
  File "<__array_function__ internals>", line 6, in amin
  File "/fs/home/krohn/.conda/envs/tttr/lib/python3.7/site-packages/numpy/core/fromnumeric.py", line 2859, in amin
keepdims=keepdims, initial=initial, where=where)
  File "/fs/home/krohn/.conda/envs/tttr/lib/python3.7/site-packages/numpy/core/fromnumeric.py", line 87, in _wrapreduction
return ufunc.reduce(obj, axis, dtype, out, **passkwargs)
ValueError: zero-size array to reduction operation minimum which has no identity




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2024-07-31, 13:11:32
35 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 1826062




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2024-07-31, 13:11:32
35 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 1826062




---------------------------------------------
---------------------------------------------
afterpulse_correlation: Created afterpulsing prediction using biexponential model
(Called by correlation_apply_filters)
2024-07-31, 13:11:33
35 output files generated so far.

Expression:
  (A1 * exp(-t/tau1) + A2 * exp(-t/tau2)) * micro_time_gate_correction / (1 + (A1 * tau1 + A2 * tau2)) / count_rate
  Parameters used:
  channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
  A1 [GHz]: 3.0646300000000004e-07
  tau1 [ns]: 7437.91
  A2 [GHz]: 4.1057500000000005e-06
  tau2 [ns]: 310.915
  count rate [GHz]: 3.0434344550423708e-05
  amplitude correction factor for afterpulses discarded by micro time gating: 1.0
  



---------------------------------------------
---------------------------------------------
correlation_apply_filters: Calculate correlation function applying various filters
(Called by get_correlation_uncertainty)
2024-07-31, 13:11:33
35 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,))), ((1,), ((), (0,)))
ext_indices specified: False
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
-> Actual shortest and longest lag times calculated [ns]: 1022.5286308016623, 939550401.9112535.
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Average count rates (considering corrections and weights) [GHz]:
First correlation channel: 3.0434344550423708e-05
Second correlation channel: 3.0434344550423708e-05

Calculated as auto-correlation function.




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2024-07-31, 13:11:33
35 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: True
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 337106




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2024-07-31, 13:11:33
35 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: True
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 337106




---------------------------------------------
---------------------------------------------
afterpulse_correlation: Created afterpulsing prediction using biexponential model
(Called by correlation_apply_filters)
2024-07-31, 13:11:34
35 output files generated so far.

Expression:
  (A1 * exp(-t/tau1) + A2 * exp(-t/tau2)) * micro_time_gate_correction / (1 + (A1 * tau1 + A2 * tau2)) / count_rate
  Parameters used:
  channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
  A1 [GHz]: 3.0646300000000004e-07
  tau1 [ns]: 7437.91
  A2 [GHz]: 4.1057500000000005e-06
  tau2 [ns]: 310.915
  count rate [GHz]: 5.6184338951924555e-05
  amplitude correction factor for afterpulses discarded by micro time gating: 1.0
  



---------------------------------------------
---------------------------------------------
correlation_apply_filters: Calculate correlation function applying various filters
(Called by get_segment_ccs)
2024-07-31, 13:11:34
35 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,))), ((1,), ((), (0,)))
ext_indices specified: True
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
-> Actual shortest and longest lag times calculated [ns]: 1022.5286308016623, 939550401.9112535.
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Average count rates (considering corrections and weights) [GHz]:
First correlation channel: 5.6184338951924555e-05
Second correlation channel: 5.6184338951924555e-05

Calculated as auto-correlation function.




---------------------------------------------
---------------------------------------------
get_segment_ccs: Calculate correlation functions with filters for evenly spaces time segments of the measurement.
(Called by get_Wohland_SD)
2024-07-31, 13:11:36
36 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,))), ((1,), ((), (0,)))
minimum_window_length (shortest allowed window length) [s]: 6.000005465153025
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Split time trace of length 60.0 s into 10 segments, of which 10 were usable.
Wrote results to ../test_data/2ch_setup/20240731_1300_LLPS_dense_AF647_bleaching/35_segment_ACFs_ch1.csv/png



---------------------------------------------
---------------------------------------------
get_Wohland_SD: Calculate correlation functions uncertainty using Wohland method.
(Called by get_correlation_uncertainty)
2024-07-31, 13:11:36
36 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,))), ((1,), ((), (0,)))
minimum_window_length (shortest allowed window length) [s]: 6.000005465153024
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

  
Used 10 segments for uncertainty estimation.




---------------------------------------------
---------------------------------------------
get_correlation_uncertainty: Calculate correlation function and uncertainty.
(Called by 03_batch_processing.py)
2024-07-31, 13:11:36
37 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,))), ((1,), ((), (0,)))
default_uncertainty_method (whether to try Wohland method SD calculation or directly use bootstrap): Wohland
minimum_window_length (shortest allowed window length) [s]: []
n_bootstrap_reps (number of bootstrap replicates to perform) 10
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: None, None
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Results written to ../test_data/2ch_setup/20240731_1300_LLPS_dense_AF647_bleaching/36_ACF_ch1.csv/png



---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by get_trace_time_scale)
2024-07-31, 13:11:36
37 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 1826062




---------------------------------------------
---------------------------------------------
get_trace_time_scale: Automatically estimate a reasonable time trace bin width from data.
(Called by 03_batch_processing.py)
2024-07-31, 13:11:36
37 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
min_avg_counts (criterion 1: minimum average counts per bin): 10.0
min_bin_width (criterion 2: minimum absolute bin width) [s]: 0.0001
use_tau_diff (whether to use diffusion time estimate as criterion 3): False
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False


Used only count rate and absolute minimum bin width as criteria, ignoring diffusion kinetics.

1. time_for_min_avg_counts [ns]: {time_for_min_avg_counts}
2. min_bin_width [ns]: {min_bin_width_ns}

Settled for time_trace_sampling [ns]: {time_trace_sampling}




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by get_time_trace)
2024-07-31, 13:11:36
37 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 1826062




---------------------------------------------
---------------------------------------------
get_time_trace: Bin photons into time trace, applying filters.
(Called by 03_batch_processing.py)
2024-07-31, 13:11:37
38 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
time_trace_sampling (time trace bin width) [s]: 0.0003285762183952694
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Split 60.0 s long acquisition into 182606 bins with an average of 9.999994523728684 counts per bin.
Wrote results to ../test_data/2ch_setup/20240731_1300_LLPS_dense_AF647_bleaching/37_Trace_ch1.csv/png



---------------------------------------------
---------------------------------------------
get_auto_threshold: Estimate a reasonable threshold photon count value from data using statistical criteria.
(Called by threshold_trace)
2024-07-31, 13:11:37
38 output files generated so far.

Parameters used:
time_trace: pre-binned photon time trace of length 182606 and an average of 9.999994523728684 counts per bin
threshold_alpha (approx. false-positive thresholding rate to be allowed by threshold): 0.02

Approximated the photon count distribution as a Gaussian with mean 9.0 and standard deviation 5.0.
Based on that, settled for a threshold of 34.




---------------------------------------------
---------------------------------------------
threshold_trace: Apply threshold to a pre-binned time trace to detect bursts.
(Called by run_burst_removal)
2024-07-31, 13:11:37
38 output files generated so far.

Parameters used:
time_trace: pre-binned photon time trace of length 182606 and an average of 9.999994523728684 counts per bin
threshold_alpha (approx. false-positive thresholding rate to be allowed in case of auto-thresholding): 0.02
-> Auto-thresholding used: True
threshold_counts (actual threshold used): 34

Thresholded the time trace, identifying 782 bins as bursts. 




---------------------------------------------
---------------------------------------------
update_photons_from_bursts: Use thresholded (re-binned) time trace to update photon information.
(Called by run_burst_removal)
2024-07-31, 13:11:43
38 output files generated so far.

Parameters used:
  burst_bins: thresholded, binary, time trace with 182606 bins of which 782 are labelled as burst bins
  time_trace_sampling (time trace bin width) [s]: 0.0003285762183952694
  update_weights (whether to label the burst photons as photons to exclude from processed by setting their weights to 0): True
  update_macro_times (whether to update the macro time labled to close gaps in the photon stream created by discarding burst photons): True
  
  Out of 3661615 photons included in burst annotation, 71954 were actually labelled as burst photons.
  



---------------------------------------------
---------------------------------------------
run_burst_removal: Use one or multiple time traces for burst removal.
(Called by 03_batch_processing.py)
2024-07-31, 13:11:44
39 output files generated so far.

Parameters used:
  time_trace: 1 pre-binned photon time traces of length 182606 and averages of 9.999994523728684 counts per bin
  time_trace_sampling (time trace bin width) [s]: 0.0003285762183952694
  threshold_alpha (approx. false-positive thresholding rate to be allowed in case of auto-thresholding): 0.02
  threshold_counts (actual threshold used): None
  update_weights (whether to label the burst photons as photons to exclude from processed by setting their weights to 0): True
  update_macro_times (whether to update the macro time labled to close gaps in the photon stream created by discarding burst photons): True
  
  Burst detection on a single trace.
  Overall detected 782 burst bins in 182606 bins.  
  Out of 3661615 photons included in burst annotation, 71954 were actually labelled as burst photons.
  Wrote results to ../test_data/2ch_setup/20240731_1300_LLPS_dense_AF647_bleaching/38_Burst_annotation_single_trace.csv/png



---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2024-07-31, 13:11:44
39 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 1788716




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2024-07-31, 13:11:44
39 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 1788716




---------------------------------------------
---------------------------------------------
afterpulse_correlation: Created afterpulsing prediction using biexponential model
(Called by correlation_apply_filters)
2024-07-31, 13:11:45
39 output files generated so far.

Expression:
  (A1 * exp(-t/tau1) + A2 * exp(-t/tau2)) * micro_time_gate_correction / (1 + (A1 * tau1 + A2 * tau2)) / count_rate
  Parameters used:
  channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
  A1 [GHz]: 3.0646300000000004e-07
  tau1 [ns]: 7437.91
  A2 [GHz]: 4.1057500000000005e-06
  tau2 [ns]: 310.915
  count rate [GHz]: 2.9940369512863363e-05
  amplitude correction factor for afterpulses discarded by micro time gating: 1.0
  



---------------------------------------------
---------------------------------------------
correlation_apply_filters: Calculate correlation function applying various filters
(Called by get_correlation_uncertainty)
2024-07-31, 13:11:45
39 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,))), ((1,), ((), (0,)))
ext_indices specified: False
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
-> Actual shortest and longest lag times calculated [ns]: 1022.5286308016623, 939550401.9112535.
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Average count rates (considering corrections and weights) [GHz]:
First correlation channel: 2.9940369512863363e-05
Second correlation channel: 2.9940369512863363e-05

Calculated as auto-correlation function.




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2024-07-31, 13:11:45
39 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: True
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 320336




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2024-07-31, 13:11:45
39 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: True
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 320336




---------------------------------------------
---------------------------------------------
afterpulse_correlation: Created afterpulsing prediction using biexponential model
(Called by correlation_apply_filters)
2024-07-31, 13:11:46
39 output files generated so far.

Expression:
  (A1 * exp(-t/tau1) + A2 * exp(-t/tau2)) * micro_time_gate_correction / (1 + (A1 * tau1 + A2 * tau2)) / count_rate
  Parameters used:
  channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
  A1 [GHz]: 3.0646300000000004e-07
  tau1 [ns]: 7437.91
  A2 [GHz]: 4.1057500000000005e-06
  tau2 [ns]: 310.915
  count rate [GHz]: 5.361962086075514e-05
  amplitude correction factor for afterpulses discarded by micro time gating: 1.0
  



---------------------------------------------
---------------------------------------------
correlation_apply_filters: Calculate correlation function applying various filters
(Called by get_segment_ccs)
2024-07-31, 13:11:46
39 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,))), ((1,), ((), (0,)))
ext_indices specified: True
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
-> Actual shortest and longest lag times calculated [ns]: 1022.5286308016623, 939550401.9112535.
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Average count rates (considering corrections and weights) [GHz]:
First correlation channel: 5.361962086075514e-05
Second correlation channel: 5.361962086075514e-05

Calculated as auto-correlation function.




---------------------------------------------
---------------------------------------------
get_segment_ccs: Calculate correlation functions with filters for evenly spaces time segments of the measurement.
(Called by get_Wohland_SD)
2024-07-31, 13:11:49
40 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,))), ((1,), ((), (0,)))
minimum_window_length (shortest allowed window length) [s]: 5.974262709355863
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Split time trace of length 60.0 s into 10 segments, of which 10 were usable.
Wrote results to ../test_data/2ch_setup/20240731_1300_LLPS_dense_AF647_bleaching/39_segment_ACFs_ch1_br.csv/png



---------------------------------------------
---------------------------------------------
get_Wohland_SD: Calculate correlation functions uncertainty using Wohland method.
(Called by get_correlation_uncertainty)
2024-07-31, 13:11:49
40 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,))), ((1,), ((), (0,)))
minimum_window_length (shortest allowed window length) [s]: 5.9742627093558625
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

  
Used 10 segments for uncertainty estimation.




---------------------------------------------
---------------------------------------------
get_correlation_uncertainty: Calculate correlation function and uncertainty.
(Called by 03_batch_processing.py)
2024-07-31, 13:11:49
41 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,))), ((1,), ((), (0,)))
default_uncertainty_method (whether to try Wohland method SD calculation or directly use bootstrap): Wohland
minimum_window_length (shortest allowed window length) [s]: []
n_bootstrap_reps (number of bootstrap replicates to perform) 10
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: None, None
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Results written to ../test_data/2ch_setup/20240731_1300_LLPS_dense_AF647_bleaching/40_ACF_ch1_br.csv/png



---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by get_trace_time_scale)
2024-07-31, 13:11:49
41 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 1788716




---------------------------------------------
---------------------------------------------
get_trace_time_scale: Automatically estimate a reasonable time trace bin width from data.
(Called by 03_batch_processing.py)
2024-07-31, 13:11:49
41 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
min_avg_counts (criterion 1: minimum average counts per bin): 10.0
min_bin_width (criterion 2: minimum absolute bin width) [s]: 0.0001
use_tau_diff (whether to use diffusion time estimate as criterion 3): False
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False


Used only count rate and absolute minimum bin width as criteria, ignoring diffusion kinetics.

1. time_for_min_avg_counts [ns]: {time_for_min_avg_counts}
2. min_bin_width [ns]: {min_bin_width_ns}

Settled for time_trace_sampling [ns]: {time_trace_sampling}




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by get_time_trace)
2024-07-31, 13:11:49
41 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 1788716




---------------------------------------------
---------------------------------------------
get_time_trace: Bin photons into time trace, applying filters.
(Called by 03_batch_processing.py)
2024-07-31, 13:11:52
42 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
time_trace_sampling (time trace bin width) [s]: 0.0003339972756634291
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Split 60.0 s long acquisition into 178871 bins with an average of 10.000011181242348 counts per bin.
Wrote results to ../test_data/2ch_setup/20240731_1300_LLPS_dense_AF647_bleaching/41_Trace_ch1_br.csv/png



---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by polynomial_undrifting_rss)
2024-07-31, 13:15:09
42 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 1788716




---------------------------------------------
---------------------------------------------
polynomial_undrifting_rss: Fit time trace with a polynomial model to describe bleaching/drift trend, and correct it.
(Called by 03_batch_processing.py)
2024-07-31, 13:15:12
43 output files generated so far.

Parameters used:
time_trace: pre-binned photon time trace of length 178871 and an average of 10.000011181242348 counts per bin
time_trace_bin_centers: bin centers [ns] for time trace, binwidth is 333997.27566342906 ns.
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
undrift_order (polynomial fit order used to describe the beaching/drift trend): 10
-> Auto-tuned undrift fit order based on residual sum of squares.
max_undrift_order (in case of auto-tuning of undrift-order, what was the maximum allowed order): 10
update_undrift_weights (whether to write the results of undrifting into the photon weights for further processing): True
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Corrected 1788716 photons with bleaching/drift trend model model b(t[ns]):  
b(t[ns]) = 26.75793529534777 + (-7.2465048484437875e-09)*t^1 + (1.64521829761204e-18)*t^2 + (-2.1572307663154667e-28)*t^3 + (1.7060020884597084e-38)*t^4 + (-8.52443506091888e-49)*t^5 + (2.753615786564303e-59)*t^6 + (-5.7332479624241336e-70)*t^7 + (7.422826513662804e-81)*t^8 + (-5.4317004037924773e-92)*t^9 + (1.715094234794904e-103)*t^10
Wrote results to ../test_data/2ch_setup/20240731_1300_LLPS_dense_AF647_bleaching/42_Trace_ch1_br_undrift_fit.csv/png



---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2024-07-31, 13:15:12
43 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 1788716




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2024-07-31, 13:15:12
43 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 1788716




---------------------------------------------
---------------------------------------------
afterpulse_correlation: Created afterpulsing prediction using biexponential model
(Called by correlation_apply_filters)
2024-07-31, 13:15:14
43 output files generated so far.

Expression:
  (A1 * exp(-t/tau1) + A2 * exp(-t/tau2)) * micro_time_gate_correction / (1 + (A1 * tau1 + A2 * tau2)) / count_rate
  Parameters used:
  channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
  A1 [GHz]: 3.0646300000000004e-07
  tau1 [ns]: 7437.91
  A2 [GHz]: 4.1057500000000005e-06
  tau2 [ns]: 310.915
  count rate [GHz]: 6.484100719124943e-05
  amplitude correction factor for afterpulses discarded by micro time gating: 1.0
  



---------------------------------------------
---------------------------------------------
correlation_apply_filters: Calculate correlation function applying various filters
(Called by get_correlation_uncertainty)
2024-07-31, 13:15:14
43 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,))), ((1,), ((), (0,)))
ext_indices specified: False
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
-> Actual shortest and longest lag times calculated [ns]: 1022.5286308016623, 939550401.9112535.
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Average count rates (considering corrections and weights) [GHz]:
First correlation channel: 6.484100719124943e-05
Second correlation channel: 6.484100719124943e-05

Calculated as auto-correlation function.




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2024-07-31, 13:15:14
43 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: True
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 320336




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2024-07-31, 13:15:14
43 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: True
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 320336




---------------------------------------------
---------------------------------------------
afterpulse_correlation: Created afterpulsing prediction using biexponential model
(Called by correlation_apply_filters)
2024-07-31, 13:15:14
43 output files generated so far.

Expression:
  (A1 * exp(-t/tau1) + A2 * exp(-t/tau2)) * micro_time_gate_correction / (1 + (A1 * tau1 + A2 * tau2)) / count_rate
  Parameters used:
  channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
  A1 [GHz]: 3.0646300000000004e-07
  tau1 [ns]: 7437.91
  A2 [GHz]: 4.1057500000000005e-06
  tau2 [ns]: 310.915
  count rate [GHz]: 7.840825359221275e-05
  amplitude correction factor for afterpulses discarded by micro time gating: 1.0
  



---------------------------------------------
---------------------------------------------
correlation_apply_filters: Calculate correlation function applying various filters
(Called by get_segment_ccs)
2024-07-31, 13:15:14
43 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,))), ((1,), ((), (0,)))
ext_indices specified: True
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
-> Actual shortest and longest lag times calculated [ns]: 1022.5286308016623, 939550401.9112535.
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Average count rates (considering corrections and weights) [GHz]:
First correlation channel: 7.840825359221275e-05
Second correlation channel: 7.840825359221275e-05

Calculated as auto-correlation function.




---------------------------------------------
---------------------------------------------
get_segment_ccs: Calculate correlation functions with filters for evenly spaces time segments of the measurement.
(Called by get_Wohland_SD)
2024-07-31, 13:15:17
44 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,))), ((1,), ((), (0,)))
minimum_window_length (shortest allowed window length) [s]: 5.974262709355863
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Split time trace of length 60.0 s into 10 segments, of which 10 were usable.
Wrote results to ../test_data/2ch_setup/20240731_1300_LLPS_dense_AF647_bleaching/43_segment_ACFs_ch1_br_dt.csv/png



---------------------------------------------
---------------------------------------------
get_Wohland_SD: Calculate correlation functions uncertainty using Wohland method.
(Called by get_correlation_uncertainty)
2024-07-31, 13:15:17
44 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,))), ((1,), ((), (0,)))
minimum_window_length (shortest allowed window length) [s]: 5.9742627093558625
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

  
Used 10 segments for uncertainty estimation.




---------------------------------------------
---------------------------------------------
get_correlation_uncertainty: Calculate correlation function and uncertainty.
(Called by 03_batch_processing.py)
2024-07-31, 13:15:17
45 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,))), ((1,), ((), (0,)))
default_uncertainty_method (whether to try Wohland method SD calculation or directly use bootstrap): Wohland
minimum_window_length (shortest allowed window length) [s]: []
n_bootstrap_reps (number of bootstrap replicates to perform) 10
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: None, None
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Results written to ../test_data/2ch_setup/20240731_1300_LLPS_dense_AF647_bleaching/44_ACF_ch1_br_dt.csv/png



---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2024-07-31, 13:15:17
45 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: True
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 320336




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2024-07-31, 13:15:17
45 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: True
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 320336




---------------------------------------------
---------------------------------------------
afterpulse_correlation: Created afterpulsing prediction using biexponential model
(Called by correlation_apply_filters)
2024-07-31, 13:15:18
45 output files generated so far.

Expression:
  (A1 * exp(-t/tau1) + A2 * exp(-t/tau2)) * micro_time_gate_correction / (1 + (A1 * tau1 + A2 * tau2)) / count_rate
  Parameters used:
  channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
  A1 [GHz]: 3.0646300000000004e-07
  tau1 [ns]: 7437.91
  A2 [GHz]: 4.1057500000000005e-06
  tau2 [ns]: 310.915
  count rate [GHz]: 7.840825359221275e-05
  amplitude correction factor for afterpulses discarded by micro time gating: 1.0
  



---------------------------------------------
---------------------------------------------
correlation_apply_filters: Calculate correlation function applying various filters
(Called by get_segment_ccs)
2024-07-31, 13:15:18
45 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,))), ((1,), ((), (0,)))
ext_indices specified: True
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 100000.0, 1000000000.0
-> Actual shortest and longest lag times calculated [ns]: 114689.71131191673, 939550401.9112535.
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Average count rates (considering corrections and weights) [GHz]:
First correlation channel: 7.840825359221275e-05
Second correlation channel: 7.840825359221275e-05

Calculated as auto-correlation function.




---------------------------------------------
---------------------------------------------
get_segment_ccs: Calculate correlation functions with filters for evenly spaces time segments of the measurement.
(Called by run_mse_filter)
2024-07-31, 13:15:20
46 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,))), ((1,), ((), (0,)))
minimum_window_length (shortest allowed window length) [s]: 5.974262709355863
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 100000.0, 1000000000.0
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Split time trace of length 60.0 s into 10 segments, of which 10 were usable.
Wrote results to ../test_data/2ch_setup/20240731_1300_LLPS_dense_AF647_bleaching/45_segment_ACFs_ch1_br_dt.csv/png



---------------------------------------------
---------------------------------------------
cc_mse_filter_get_mse: Iteratively compare correlation functions to flag potential outliers through mean-square error statistics.
(Called by run_mse_filter)
2024-07-31, 13:15:21
46 output files generated so far.

Parameters used:
  segment_ccs: Set of 10 correlation functions to compare, each containing 79 data points
  ignore_amplitude_fluctuations (whether to linearly scale data to emphasise correlation function shape anomalies over amplitude fluctuations): True
  
  Found mean-square error values varying over a factor of 8.399999618530273. 
  



---------------------------------------------
---------------------------------------------
run_mse_filter: Segment photon stream into time windows, correlate them, and remove outliers with anomalous correlation function.
(Called by 03_batch_processing.py)
2024-07-31, 13:15:21
47 output files generated so far.

Parameters_used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,))), ((1,), ((), (0,)))
minimum_window_length (shortest allowed window length) [s]: Automatically chosen as 5.9742627093558625
mse_fold_threshold (mean-square error fold-change threshold for discarding segments): 2.5
ignore_amplitude_fluctuations (whether to linearly scale data to emphasise correlation function shape anomalies over amplitude fluctuations): True
update_macro_times (whether to update the macro time labled to close gaps in the photon stream created by discarding burst photons): True
update_weights (whether to label the burst photons as photons to exclude from processed by setting their weights to 0): True
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 100000.0, 1000000000.0
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True

Out of 3661615 photons, 685703 were discarded.

  Split data into 10 segments, of which 10 were worth looking at, and 9 were kept in the end.
  Wrote results to ../test_data/2ch_setup/20240731_1300_LLPS_dense_AF647_bleaching/46_anom_ACF_rem_ch1_br_dt.csv/png



---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2024-07-31, 13:15:21
47 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

overall number of photons selected: 1468380




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2024-07-31, 13:15:21
47 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

overall number of photons selected: 1468380




---------------------------------------------
---------------------------------------------
afterpulse_correlation: Created afterpulsing prediction using biexponential model
(Called by correlation_apply_filters)
2024-07-31, 13:15:22
47 output files generated so far.

Expression:
  (A1 * exp(-t/tau1) + A2 * exp(-t/tau2)) * micro_time_gate_correction / (1 + (A1 * tau1 + A2 * tau2)) / count_rate
  Parameters used:
  channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
  A1 [GHz]: 3.0646300000000004e-07
  tau1 [ns]: 7437.91
  A2 [GHz]: 4.1057500000000005e-06
  tau2 [ns]: 310.915
  count rate [GHz]: 6.333365821458552e-05
  amplitude correction factor for afterpulses discarded by micro time gating: 1.0
  



---------------------------------------------
---------------------------------------------
correlation_apply_filters: Calculate correlation function applying various filters
(Called by get_correlation_uncertainty)
2024-07-31, 13:15:22
47 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,))), ((1,), ((), (0,)))
ext_indices specified: False
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
-> Actual shortest and longest lag times calculated [ns]: 1022.5286308016623, 939550401.9112535.
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

Average count rates (considering corrections and weights) [GHz]:
First correlation channel: 6.333365821458552e-05
Second correlation channel: 6.333365821458552e-05

Calculated as auto-correlation function.




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2024-07-31, 13:15:22
47 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: True
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

overall number of photons selected: 0




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2024-07-31, 13:15:22
47 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: True
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

overall number of photons selected: 0




---------------------------------------------
---------------------------------------------
get_segment_ccs: Calculate correlation functions with filters for evenly spaces time segments of the measurement.
(Called by get_Wohland_SD)
2024-07-31, 13:15:26
48 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,))), ((1,), ((), (0,)))
minimum_window_length (shortest allowed window length) [s]: 5.376838061465722
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

Split time trace of length 60.0 s into 12 segments, of which 10 were usable.
Wrote results to ../test_data/2ch_setup/20240731_1300_LLPS_dense_AF647_bleaching/47_segment_ACFs_ch1_br_dt_ar.csv/png



---------------------------------------------
---------------------------------------------
get_Wohland_SD: Calculate correlation functions uncertainty using Wohland method.
(Called by get_correlation_uncertainty)
2024-07-31, 13:15:26
48 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,))), ((1,), ((), (0,)))
minimum_window_length (shortest allowed window length) [s]: 5.376838061465721
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

  
Used 10 segments for uncertainty estimation.




---------------------------------------------
---------------------------------------------
get_correlation_uncertainty: Calculate correlation function and uncertainty.
(Called by 03_batch_processing.py)
2024-07-31, 13:15:26
49 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,))), ((1,), ((), (0,)))
default_uncertainty_method (whether to try Wohland method SD calculation or directly use bootstrap): Wohland
minimum_window_length (shortest allowed window length) [s]: []
n_bootstrap_reps (number of bootstrap replicates to perform) 10
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: None, None
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

Results written to ../test_data/2ch_setup/20240731_1300_LLPS_dense_AF647_bleaching/48_ACF_ch1_br_dt_ar.csv/png



---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by get_tcspc_histogram)
2024-07-31, 13:15:26
49 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

overall number of photons selected: 1468380




---------------------------------------------
---------------------------------------------
get_tcspc_histogram: Calculate a TCSPC histogram.
(Called by 03_batch_processing.py)
2024-07-31, 13:15:26
50 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))  
micro_times (time tags to histogram): from loaded TTTR retrieved  1468380 photon time tags, of which 231.9115201042135 % were ultimately used.
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

Calculated TCSPC histogram:
has 200 bins at 250.0 ps resolution
contains 3405342.37890625 photons
ranges over 49.74999859297391 ns

Wrote results to ../test_data/2ch_setup/20240731_1300_LLPS_dense_AF647_bleaching/49_TCSPC_ch1_br_dt_ar.csv/png



---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by get_tcspc_histogram)
2024-07-31, 13:15:27
50 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

overall number of photons selected: 1468380




---------------------------------------------
---------------------------------------------
get_tcspc_histogram: Calculate a TCSPC histogram.
(Called by get_background_tail_fit)
2024-07-31, 13:15:27
51 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))  
micro_times (time tags to histogram): from loaded TTTR retrieved  1468380 photon time tags, of which 231.9115201042135 % were ultimately used.
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

Calculated TCSPC histogram:
has 200 bins at 250.0 ps resolution
contains 3405342.37890625 photons
ranges over 49.74999859297391 ns

Wrote results to ../test_data/2ch_setup/20240731_1300_LLPS_dense_AF647_bleaching/50_TCSPC_ch1_br_dt_ar.csv/png



---------------------------------------------
---------------------------------------------
Error: Logging traceback.
(Called by 03_batch_processing.py)
2024-07-31, 13:15:27
51 output files generated so far.

Traceback (most recent call last):
  File "03_batch_processing.py", line 268, in <module>
calling_function = script_name)
  File "/fs/gpfs41/lv02/fileset02/pool/pool-schwille-spt/_Software/FCS_cleaner_dev/FCS_Fixer/functions/FCS_Fixer.py", line 6750, in get_background_tail_fit
'y_0': np.min(tcspc_y_crop),
  File "<__array_function__ internals>", line 6, in amin
  File "/fs/home/krohn/.conda/envs/tttr/lib/python3.7/site-packages/numpy/core/fromnumeric.py", line 2859, in amin
keepdims=keepdims, initial=initial, where=where)
  File "/fs/home/krohn/.conda/envs/tttr/lib/python3.7/site-packages/numpy/core/fromnumeric.py", line 87, in _wrapreduction
return ufunc.reduce(obj, axis, dtype, out, **passkwargs)
ValueError: zero-size array to reduction operation minimum which has no identity

