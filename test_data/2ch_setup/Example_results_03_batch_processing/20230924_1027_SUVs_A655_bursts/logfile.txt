


---------------------------------------------
---------------------------------------------
Creation:
2023-09-24, 10:27:21
0 output files generated so far.

Writing output into ../test_data/2ch_setup/20230924_1027_SUVs_A655_bursts.

Overview over loaded TTTR data:
127397 photons in total
Channels in use and how many photons are in each of them:
0: 56781, 1: 70616
9.999821045705097 s acquisition time
200 micro time bins
50.00120002880069 ns macro time resolution
0.24999999292951713 ns micro time resolution




---------------------------------------------
---------------------------------------------
set_correlation_time_params: Setting correlator settings
2023-09-24, 10:27:21
0 output files generated so far.

Parameters set:
  micro_time_corr (Use of micro time information in correlation): True
  sampling (number of samples per correlator cascade): 6
  n_casc (number of correlation cascades): 33.0
  



---------------------------------------------
---------------------------------------------
set_afterpulsing_params: Setting afterpulsing calibration parameters
2023-09-24, 10:27:21
0 output files generated so far.

loaded afterpulsing calibration file /fs/gpfs41/lv02/fileset02/pool/pool-schwille-spt/_Software/FCS_cleaner_dev/FCS_Fixer/functions/ap_params_2ch_setup.csv
  Parameters:
  A1[GHz], tau1[ns], A2[GHz], tau2[ns]:
  [[1.37470e-07 6.77435e+03 7.34693e-06 3.13849e+02]
 [3.06463e-07 7.43791e+03 4.10575e-06 3.10915e+02]]
  Channel-wise afterpulsing probabilities according to calibration:
  [0.0032371  0.00355598]
  



---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2023-09-24, 10:27:21
0 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 56781




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2023-09-24, 10:27:21
0 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 56781




---------------------------------------------
---------------------------------------------
afterpulse_correlation: Created afterpulsing prediction using biexponential model
(Called by correlation_apply_filters)
2023-09-24, 10:27:21
0 output files generated so far.

Expression:
  (A1 * exp(-t/tau1) + A2 * exp(-t/tau2)) * micro_time_gate_correction / (1 + (A1 * tau1 + A2 * tau2)) / count_rate
  Parameters used:
  channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
  A1 [GHz]: 1.3747e-07
  tau1 [ns]: 6774.349999999999
  A2 [GHz]: 7.346930000000001e-06
  tau2 [ns]: 313.849
  count rate [GHz]: 5.678633889578479e-06
  amplitude correction factor for afterpulses discarded by micro time gating: 1.0
  



---------------------------------------------
---------------------------------------------
correlation_apply_filters: Calculate correlation function applying various filters
(Called by get_correlation_uncertainty)
2023-09-24, 10:27:21
0 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((0,), ((), (0,)))
ext_indices specified: False
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
-> Actual shortest and longest lag times calculated [ns]: 1022.5245405889741, 939546643.6194469.
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Average count rates (considering corrections and weights) [GHz]:
First correlation channel: 5.678633889578479e-06
Second correlation channel: 5.678633889578479e-06

Calculated as auto-correlation function.




---------------------------------------------
---------------------------------------------
get_Wohland_SD: Calculate correlation functions uncertainty using Wohland method.
2023-09-24, 10:27:21
0 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((0,), ((), (0,)))
minimum_window_length (shortest allowed window length) [s]: 5.0
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

  
Calculation aborted and instead switched to bootstrap method uncertainty calculation due to too-short acquisition time relative to specified minimum window length.




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2023-09-24, 10:27:21
0 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: True
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 36054




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2023-09-24, 10:27:21
0 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: True
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 36054




---------------------------------------------
---------------------------------------------
afterpulse_correlation: Created afterpulsing prediction using biexponential model
(Called by correlation_apply_filters)
2023-09-24, 10:27:21
0 output files generated so far.

Expression:
  (A1 * exp(-t/tau1) + A2 * exp(-t/tau2)) * micro_time_gate_correction / (1 + (A1 * tau1 + A2 * tau2)) / count_rate
  Parameters used:
  channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
  A1 [GHz]: 1.3747e-07
  tau1 [ns]: 6774.349999999999
  A2 [GHz]: 7.346930000000001e-06
  tau2 [ns]: 313.849
  count rate [GHz]: 3.6057390016882845e-06
  amplitude correction factor for afterpulses discarded by micro time gating: 1.0
  



---------------------------------------------
---------------------------------------------
correlation_apply_filters: Calculate correlation function applying various filters
(Called by get_bootstrap_SD)
2023-09-24, 10:27:21
0 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((0,), ((), (0,)))
ext_indices specified: True
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
-> Actual shortest and longest lag times calculated [ns]: 1022.5245405889741, 939546643.6194469.
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Average count rates (considering corrections and weights) [GHz]:
First correlation channel: 3.6057390016882845e-06
Second correlation channel: 3.6057390016882845e-06

Calculated as auto-correlation function.




---------------------------------------------
---------------------------------------------
get_bootstrap_SD: Calculate correlation function uncertainty via photon bootstrapping.
(Called by get_Wohland_SD)
2023-09-24, 10:27:21
0 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((0,), ((), (0,)))
n_bootstrap_reps (number of bootstrap replicates to perform) 10
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False
  
Out of 10 bootstrap replicates, 10 were successful and could be used for uncertainty estimation.




---------------------------------------------
---------------------------------------------
get_correlation_uncertainty: Calculate correlation function and uncertainty.
(Called by 03_batch_processing.py)
2023-09-24, 10:27:22
1 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((0,), ((), (0,)))
default_uncertainty_method (whether to try Wohland method SD calculation or directly use bootstrap): Wohland
minimum_window_length (shortest allowed window length) [s]: []
n_bootstrap_reps (number of bootstrap replicates to perform) 10
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: None, None
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Results written to ../test_data/2ch_setup/20230924_1027_SUVs_A655_bursts/00_ACF_ch0.csv/png



---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by get_trace_time_scale)
2023-09-24, 10:27:22
1 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 56781




---------------------------------------------
---------------------------------------------
get_trace_time_scale: Automatically estimate a reasonable time trace bin width from data.
(Called by 03_batch_processing.py)
2023-09-24, 10:27:22
1 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
min_avg_counts (criterion 1: minimum average counts per bin): 10.0
min_bin_width (criterion 2: minimum absolute bin width) [s]: 0.0001
use_tau_diff (whether to use diffusion time estimate as criterion 3): False
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False


Used only count rate and absolute minimum bin width as criteria, ignoring diffusion kinetics.

1. time_for_min_avg_counts [ns]: {time_for_min_avg_counts}
2. min_bin_width [ns]: {min_bin_width_ns}

Settled for time_trace_sampling [ns]: {time_trace_sampling}




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by get_time_trace)
2023-09-24, 10:27:22
1 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 56781




---------------------------------------------
---------------------------------------------
get_time_trace: Bin photons into time trace, applying filters.
(Called by 03_batch_processing.py)
2023-09-24, 10:27:22
2 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
time_trace_sampling (time trace bin width) [s]: 0.0017611209816144658
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Split 10.0 s long acquisition into 5678 bins with an average of 9.99929552659387 counts per bin.
Wrote results to ../test_data/2ch_setup/20230924_1027_SUVs_A655_bursts/01_Trace_ch0.csv/png



---------------------------------------------
---------------------------------------------
get_auto_threshold: Estimate a reasonable threshold photon count value from data using statistical criteria.
(Called by threshold_trace)
2023-09-24, 10:27:22
2 output files generated so far.

Parameters used:
time_trace: pre-binned photon time trace of length 5678 and an average of 9.99929552659387 counts per bin
threshold_alpha (approx. false-positive thresholding rate to be allowed by threshold): 0.02

Approximated the photon count distribution as a Gaussian with mean 8.0 and standard deviation 7.0.
Based on that, settled for a threshold of 39.




---------------------------------------------
---------------------------------------------
threshold_trace: Apply threshold to a pre-binned time trace to detect bursts.
(Called by run_burst_removal)
2023-09-24, 10:27:22
2 output files generated so far.

Parameters used:
time_trace: pre-binned photon time trace of length 5678 and an average of 9.99929552659387 counts per bin
threshold_alpha (approx. false-positive thresholding rate to be allowed in case of auto-thresholding): 0.02
-> Auto-thresholding used: True
threshold_counts (actual threshold used): 39

Thresholded the time trace, identifying 51 bins as bursts. 




---------------------------------------------
---------------------------------------------
update_photons_from_bursts: Use thresholded (re-binned) time trace to update photon information.
(Called by run_burst_removal)
2023-09-24, 10:27:22
2 output files generated so far.

Parameters used:
  burst_bins: thresholded, binary, time trace with 5678 bins of which 51 are labelled as burst bins
  time_trace_sampling (time trace bin width) [s]: 0.0017611209816144658
  update_weights (whether to label the burst photons as photons to exclude from processed by setting their weights to 0): True
  update_macro_times (whether to update the macro time labled to close gaps in the photon stream created by discarding burst photons): True
  
  Out of 127397 photons included in burst annotation, 5323 were actually labelled as burst photons.
  



---------------------------------------------
---------------------------------------------
run_burst_removal: Use one or multiple time traces for burst removal.
(Called by 03_batch_processing.py)
2023-09-24, 10:27:22
3 output files generated so far.

Parameters used:
  time_trace: 1 pre-binned photon time traces of length 5678 and averages of 9.99929552659387 counts per bin
  time_trace_sampling (time trace bin width) [s]: 0.0017611209816144658
  threshold_alpha (approx. false-positive thresholding rate to be allowed in case of auto-thresholding): 0.02
  threshold_counts (actual threshold used): None
  update_weights (whether to label the burst photons as photons to exclude from processed by setting their weights to 0): True
  update_macro_times (whether to update the macro time labled to close gaps in the photon stream created by discarding burst photons): True
  
  Burst detection on a single trace.
  Overall detected 51 burst bins in 5678 bins.  
  Out of 127397 photons included in burst annotation, 5323 were actually labelled as burst photons.
  Wrote results to ../test_data/2ch_setup/20230924_1027_SUVs_A655_bursts/02_Burst_annotation_single_trace.csv/png



---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2023-09-24, 10:27:22
3 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 54289




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2023-09-24, 10:27:22
3 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 54289




---------------------------------------------
---------------------------------------------
afterpulse_correlation: Created afterpulsing prediction using biexponential model
(Called by correlation_apply_filters)
2023-09-24, 10:27:22
3 output files generated so far.

Expression:
  (A1 * exp(-t/tau1) + A2 * exp(-t/tau2)) * micro_time_gate_correction / (1 + (A1 * tau1 + A2 * tau2)) / count_rate
  Parameters used:
  channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
  A1 [GHz]: 1.3747e-07
  tau1 [ns]: 6774.349999999999
  A2 [GHz]: 7.346930000000001e-06
  tau2 [ns]: 313.849
  count rate [GHz]: 5.478622016542882e-06
  amplitude correction factor for afterpulses discarded by micro time gating: 1.0
  



---------------------------------------------
---------------------------------------------
correlation_apply_filters: Calculate correlation function applying various filters
(Called by get_correlation_uncertainty)
2023-09-24, 10:27:22
3 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((0,), ((), (0,)))
ext_indices specified: False
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
-> Actual shortest and longest lag times calculated [ns]: 1022.5245405889741, 939546643.6194469.
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Average count rates (considering corrections and weights) [GHz]:
First correlation channel: 5.478622016542882e-06
Second correlation channel: 5.478622016542882e-06

Calculated as auto-correlation function.




---------------------------------------------
---------------------------------------------
get_Wohland_SD: Calculate correlation functions uncertainty using Wohland method.
2023-09-24, 10:27:22
3 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((0,), ((), (0,)))
minimum_window_length (shortest allowed window length) [s]: 5.0
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

  
Calculation aborted and instead switched to bootstrap method uncertainty calculation due to too-short acquisition time relative to specified minimum window length.




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2023-09-24, 10:27:22
3 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: True
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 34266




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2023-09-24, 10:27:22
3 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: True
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 34266




---------------------------------------------
---------------------------------------------
afterpulse_correlation: Created afterpulsing prediction using biexponential model
(Called by correlation_apply_filters)
2023-09-24, 10:27:22
3 output files generated so far.

Expression:
  (A1 * exp(-t/tau1) + A2 * exp(-t/tau2)) * micro_time_gate_correction / (1 + (A1 * tau1 + A2 * tau2)) / count_rate
  Parameters used:
  channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
  A1 [GHz]: 1.3747e-07
  tau1 [ns]: 6774.349999999999
  A2 [GHz]: 7.346930000000001e-06
  tau2 [ns]: 313.849
  count rate [GHz]: 3.4579834224034032e-06
  amplitude correction factor for afterpulses discarded by micro time gating: 1.0
  



---------------------------------------------
---------------------------------------------
correlation_apply_filters: Calculate correlation function applying various filters
(Called by get_bootstrap_SD)
2023-09-24, 10:27:22
3 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((0,), ((), (0,)))
ext_indices specified: True
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
-> Actual shortest and longest lag times calculated [ns]: 1022.5245405889741, 939546643.6194469.
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Average count rates (considering corrections and weights) [GHz]:
First correlation channel: 3.4579834224034032e-06
Second correlation channel: 3.4579834224034032e-06

Calculated as auto-correlation function.




---------------------------------------------
---------------------------------------------
get_bootstrap_SD: Calculate correlation function uncertainty via photon bootstrapping.
(Called by get_Wohland_SD)
2023-09-24, 10:27:23
3 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((0,), ((), (0,)))
n_bootstrap_reps (number of bootstrap replicates to perform) 10
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False
  
Out of 10 bootstrap replicates, 10 were successful and could be used for uncertainty estimation.




---------------------------------------------
---------------------------------------------
get_correlation_uncertainty: Calculate correlation function and uncertainty.
(Called by 03_batch_processing.py)
2023-09-24, 10:27:23
4 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((0,), ((), (0,)))
default_uncertainty_method (whether to try Wohland method SD calculation or directly use bootstrap): Wohland
minimum_window_length (shortest allowed window length) [s]: []
n_bootstrap_reps (number of bootstrap replicates to perform) 10
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: None, None
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Results written to ../test_data/2ch_setup/20230924_1027_SUVs_A655_bursts/03_ACF_ch0_br.csv/png



---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by get_trace_time_scale)
2023-09-24, 10:27:23
4 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 54289




---------------------------------------------
---------------------------------------------
get_trace_time_scale: Automatically estimate a reasonable time trace bin width from data.
(Called by 03_batch_processing.py)
2023-09-24, 10:27:23
4 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
min_avg_counts (criterion 1: minimum average counts per bin): 10.0
min_bin_width (criterion 2: minimum absolute bin width) [s]: 0.0001
use_tau_diff (whether to use diffusion time estimate as criterion 3): False
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False


Used only count rate and absolute minimum bin width as criteria, ignoring diffusion kinetics.

1. time_for_min_avg_counts [ns]: {time_for_min_avg_counts}
2. min_bin_width [ns]: {min_bin_width_ns}

Settled for time_trace_sampling [ns]: {time_trace_sampling}




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by get_time_trace)
2023-09-24, 10:27:23
4 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 54289




---------------------------------------------
---------------------------------------------
get_time_trace: Bin photons into time trace, applying filters.
(Called by 03_batch_processing.py)
2023-09-24, 10:27:23
5 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
time_trace_sampling (time trace bin width) [s]: 0.001825416712430688
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Split 10.0 s long acquisition into 5428 bins with an average of 9.997605011053794 counts per bin.
Wrote results to ../test_data/2ch_setup/20230924_1027_SUVs_A655_bursts/04_Trace_ch0_br.csv/png



---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by polynomial_undrifting_rss)
2023-09-24, 10:27:24
5 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 54289




---------------------------------------------
---------------------------------------------
polynomial_undrifting_rss: Fit time trace with a polynomial model to describe bleaching/drift trend, and correct it.
(Called by 03_batch_processing.py)
2023-09-24, 10:27:24
6 output files generated so far.

Parameters used:
time_trace: pre-binned photon time trace of length 5428 and an average of 9.997605011053794 counts per bin
time_trace_bin_centers: bin centers [ns] for time trace, binwidth is 1825416.712430688 ns.
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
undrift_order (polynomial fit order used to describe the beaching/drift trend): 0
-> Auto-tuned undrift fit order based on residual sum of squares.
max_undrift_order (in case of auto-tuning of undrift-order, what was the maximum allowed order): 10
update_undrift_weights (whether to write the results of undrifting into the photon weights for further processing): True
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Corrected 54289 photons with bleaching/drift trend model model b(t[ns]):  
b(t[ns]) = 6.392465430484014
Wrote results to ../test_data/2ch_setup/20230924_1027_SUVs_A655_bursts/05_Trace_ch0_br_undrift_fit.csv/png



---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2023-09-24, 10:27:24
6 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 54289




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2023-09-24, 10:27:24
6 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 54289




---------------------------------------------
---------------------------------------------
afterpulse_correlation: Created afterpulsing prediction using biexponential model
(Called by correlation_apply_filters)
2023-09-24, 10:27:24
6 output files generated so far.

Expression:
  (A1 * exp(-t/tau1) + A2 * exp(-t/tau2)) * micro_time_gate_correction / (1 + (A1 * tau1 + A2 * tau2)) / count_rate
  Parameters used:
  channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
  A1 [GHz]: 1.3747e-07
  tau1 [ns]: 6774.349999999999
  A2 [GHz]: 7.346930000000001e-06
  tau2 [ns]: 313.849
  count rate [GHz]: 5.478622016542882e-06
  amplitude correction factor for afterpulses discarded by micro time gating: 1.0
  



---------------------------------------------
---------------------------------------------
correlation_apply_filters: Calculate correlation function applying various filters
(Called by get_correlation_uncertainty)
2023-09-24, 10:27:24
6 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((0,), ((), (0,)))
ext_indices specified: False
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
-> Actual shortest and longest lag times calculated [ns]: 1022.5245405889741, 939546643.6194469.
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Average count rates (considering corrections and weights) [GHz]:
First correlation channel: 5.478622016542882e-06
Second correlation channel: 5.478622016542882e-06

Calculated as auto-correlation function.




---------------------------------------------
---------------------------------------------
get_Wohland_SD: Calculate correlation functions uncertainty using Wohland method.
2023-09-24, 10:27:24
6 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((0,), ((), (0,)))
minimum_window_length (shortest allowed window length) [s]: 5.0
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

  
Calculation aborted and instead switched to bootstrap method uncertainty calculation due to too-short acquisition time relative to specified minimum window length.




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2023-09-24, 10:27:24
6 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: True
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 34474




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2023-09-24, 10:27:24
6 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: True
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 34474




---------------------------------------------
---------------------------------------------
afterpulse_correlation: Created afterpulsing prediction using biexponential model
(Called by correlation_apply_filters)
2023-09-24, 10:27:24
6 output files generated so far.

Expression:
  (A1 * exp(-t/tau1) + A2 * exp(-t/tau2)) * micro_time_gate_correction / (1 + (A1 * tau1 + A2 * tau2)) / count_rate
  Parameters used:
  channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
  A1 [GHz]: 1.3747e-07
  tau1 [ns]: 6774.349999999999
  A2 [GHz]: 7.346930000000001e-06
  tau2 [ns]: 313.849
  count rate [GHz]: 3.4789745566707545e-06
  amplitude correction factor for afterpulses discarded by micro time gating: 1.0
  



---------------------------------------------
---------------------------------------------
correlation_apply_filters: Calculate correlation function applying various filters
(Called by get_bootstrap_SD)
2023-09-24, 10:27:24
6 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((0,), ((), (0,)))
ext_indices specified: True
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
-> Actual shortest and longest lag times calculated [ns]: 1022.5245405889741, 939546643.6194469.
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Average count rates (considering corrections and weights) [GHz]:
First correlation channel: 3.4789745566707545e-06
Second correlation channel: 3.4789745566707545e-06

Calculated as auto-correlation function.




---------------------------------------------
---------------------------------------------
get_bootstrap_SD: Calculate correlation function uncertainty via photon bootstrapping.
(Called by get_Wohland_SD)
2023-09-24, 10:27:24
6 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((0,), ((), (0,)))
n_bootstrap_reps (number of bootstrap replicates to perform) 10
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False
  
Out of 10 bootstrap replicates, 10 were successful and could be used for uncertainty estimation.




---------------------------------------------
---------------------------------------------
get_correlation_uncertainty: Calculate correlation function and uncertainty.
(Called by 03_batch_processing.py)
2023-09-24, 10:27:25
7 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((0,), ((), (0,)))
default_uncertainty_method (whether to try Wohland method SD calculation or directly use bootstrap): Wohland
minimum_window_length (shortest allowed window length) [s]: []
n_bootstrap_reps (number of bootstrap replicates to perform) 10
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: None, None
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Results written to ../test_data/2ch_setup/20230924_1027_SUVs_A655_bursts/06_ACF_ch0_br_dt.csv/png



---------------------------------------------
---------------------------------------------
run_mse_filter: Segment photon stream into time windows, correlate them, and remove outliers with anomalous correlation function.
(Called by 03_batch_processing.py)
2023-09-24, 10:27:25
7 output files generated so far.

Parameters_used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((0,), ((), (0,)))
minimum_window_length (shortest allowed window length) [s]: Automatically chosen as 5.0
mse_fold_threshold (mean-square error fold-change threshold for discarding segments): 2.5
ignore_amplitude_fluctuations (whether to linearly scale data to emphasise correlation function shape anomalies over amplitude fluctuations): True
update_macro_times (whether to update the macro time labled to close gaps in the photon stream created by discarding burst photons): True
update_weights (whether to label the burst photons as photons to exclude from processed by setting their weights to 0): True
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 100000.0, 1000000000.0
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True

Could not fit enough segments of specified window size into acquisition time. Skipped.




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2023-09-24, 10:27:25
7 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

overall number of photons selected: 54289




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2023-09-24, 10:27:25
7 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

overall number of photons selected: 54289




---------------------------------------------
---------------------------------------------
afterpulse_correlation: Created afterpulsing prediction using biexponential model
(Called by correlation_apply_filters)
2023-09-24, 10:27:25
7 output files generated so far.

Expression:
  (A1 * exp(-t/tau1) + A2 * exp(-t/tau2)) * micro_time_gate_correction / (1 + (A1 * tau1 + A2 * tau2)) / count_rate
  Parameters used:
  channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
  A1 [GHz]: 1.3747e-07
  tau1 [ns]: 6774.349999999999
  A2 [GHz]: 7.346930000000001e-06
  tau2 [ns]: 313.849
  count rate [GHz]: 5.478622016542882e-06
  amplitude correction factor for afterpulses discarded by micro time gating: 1.0
  



---------------------------------------------
---------------------------------------------
correlation_apply_filters: Calculate correlation function applying various filters
(Called by get_correlation_uncertainty)
2023-09-24, 10:27:25
7 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((0,), ((), (0,)))
ext_indices specified: False
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
-> Actual shortest and longest lag times calculated [ns]: 1022.5245405889741, 939546643.6194469.
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

Average count rates (considering corrections and weights) [GHz]:
First correlation channel: 5.478622016542882e-06
Second correlation channel: 5.478622016542882e-06

Calculated as auto-correlation function.




---------------------------------------------
---------------------------------------------
get_Wohland_SD: Calculate correlation functions uncertainty using Wohland method.
2023-09-24, 10:27:25
7 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((0,), ((), (0,)))
minimum_window_length (shortest allowed window length) [s]: 5.0
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

  
Calculation aborted and instead switched to bootstrap method uncertainty calculation due to too-short acquisition time relative to specified minimum window length.




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2023-09-24, 10:27:25
7 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: True
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

overall number of photons selected: 34218




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2023-09-24, 10:27:25
7 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: True
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

overall number of photons selected: 34218




---------------------------------------------
---------------------------------------------
afterpulse_correlation: Created afterpulsing prediction using biexponential model
(Called by correlation_apply_filters)
2023-09-24, 10:27:25
7 output files generated so far.

Expression:
  (A1 * exp(-t/tau1) + A2 * exp(-t/tau2)) * micro_time_gate_correction / (1 + (A1 * tau1 + A2 * tau2)) / count_rate
  Parameters used:
  channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
  A1 [GHz]: 1.3747e-07
  tau1 [ns]: 6774.349999999999
  A2 [GHz]: 7.346930000000001e-06
  tau2 [ns]: 313.849
  count rate [GHz]: 3.4531944869856896e-06
  amplitude correction factor for afterpulses discarded by micro time gating: 1.0
  



---------------------------------------------
---------------------------------------------
correlation_apply_filters: Calculate correlation function applying various filters
(Called by get_bootstrap_SD)
2023-09-24, 10:27:25
7 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((0,), ((), (0,)))
ext_indices specified: True
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
-> Actual shortest and longest lag times calculated [ns]: 1022.5245405889741, 939546643.6194469.
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

Average count rates (considering corrections and weights) [GHz]:
First correlation channel: 3.4531944869856896e-06
Second correlation channel: 3.4531944869856896e-06

Calculated as auto-correlation function.




---------------------------------------------
---------------------------------------------
get_bootstrap_SD: Calculate correlation function uncertainty via photon bootstrapping.
(Called by get_Wohland_SD)
2023-09-24, 10:27:25
7 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((0,), ((), (0,)))
n_bootstrap_reps (number of bootstrap replicates to perform) 10
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True
  
Out of 10 bootstrap replicates, 10 were successful and could be used for uncertainty estimation.




---------------------------------------------
---------------------------------------------
get_correlation_uncertainty: Calculate correlation function and uncertainty.
(Called by 03_batch_processing.py)
2023-09-24, 10:27:26
8 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((0,), ((), (0,)))
default_uncertainty_method (whether to try Wohland method SD calculation or directly use bootstrap): Wohland
minimum_window_length (shortest allowed window length) [s]: []
n_bootstrap_reps (number of bootstrap replicates to perform) 10
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: None, None
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

Results written to ../test_data/2ch_setup/20230924_1027_SUVs_A655_bursts/07_ACF_ch0_br_dt_ar.csv/png



---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by get_tcspc_histogram)
2023-09-24, 10:27:26
8 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

overall number of photons selected: 54289




---------------------------------------------
---------------------------------------------
get_tcspc_histogram: Calculate a TCSPC histogram.
(Called by 03_batch_processing.py)
2023-09-24, 10:27:26
9 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))  
micro_times (time tags to histogram): from loaded TTTR retrieved  54289 photon time tags, of which 100.0 % were ultimately used.
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

Calculated TCSPC histogram:
has 199 bins at 250.0 ps resolution
contains 54289.0 photons
ranges over 49.74999859297391 ns

Wrote results to ../test_data/2ch_setup/20230924_1027_SUVs_A655_bursts/08_TCSPC_ch0_br_dt_ar.csv/png



---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by get_tcspc_histogram)
2023-09-24, 10:27:26
9 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

overall number of photons selected: 54289




---------------------------------------------
---------------------------------------------
get_tcspc_histogram: Calculate a TCSPC histogram.
(Called by get_background_tail_fit)
2023-09-24, 10:27:26
10 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))  
micro_times (time tags to histogram): from loaded TTTR retrieved  54289 photon time tags, of which 100.0 % were ultimately used.
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

Calculated TCSPC histogram:
has 199 bins at 250.0 ps resolution
contains 54289.0 photons
ranges over 49.74999859297391 ns

Wrote results to ../test_data/2ch_setup/20230924_1027_SUVs_A655_bursts/09_TCSPC_ch0_br_dt_ar.csv/png



---------------------------------------------
---------------------------------------------
get_background_tail_fit: Fit an exponential decay to the tail of a TCSPC histogram to determine the flat background level.
(Called by 03_batch_processing.py)
2023-09-24, 10:27:27
11 output files generated so far.

Parameters used:
  channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
  irf_peak_center (as reference point for the amplitude) [micro time channels]: 11
  fit_start (left edge of time window to include in fit) [micro time channels]: 20
  ext_indices specified: False
  use_ext_weights (use of weights for FLCS etc.): False
  use_drift_correction (use of weights for bleaching/drift correction etc.): True
  use_burst_removal (removal of photons assigned as burst photons): True
  use_mse_filter (removal of photons in segments with anomalous correlation function): True

  Included 54289.0 photons in fit.
  Fitted the following parameters (reduced chi-square: 1.3398367434005285):
  y_0 (laser-independent background) [counts per micro time channel]: 3.257330201664831
  exp_tau (1/e decay time of the exponential) [TCSPC time channels]: 12.364762470338512
  amp (exponential decay amplitude) [counts per micro time channel]: 3560.3000226413774
  
  Wrote results to ../test_data/2ch_setup/20230924_1027_SUVs_A655_bursts/10_Tail_fit0_br_dt_ar.csv/png



---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by get_flcs_background_filter)
2023-09-24, 10:27:27
11 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): True
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 56781




---------------------------------------------
---------------------------------------------
get_flcs_background_filter: Use a previously determined (flat) background level to determine FLCS/fFCS filters for background suppression.
(Called by 03_batch_processing.py)
2023-09-24, 10:27:27
12 output files generated so far.

Parameters used:
  tcspc_x (TCSPC bin indices) and tcspc_y (full TCSPC histogram corresponding to those bins): 199 bins, among those 0 empty bins, 54289.0 photons
  flat_background (flat background level) [counts per TCSPC bin]: 3.257330201664831
  channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
  handle_outside (what to do with photons outside in bins tcspc_x: 'zero' (discard photons outside tcspc_x)
  update_weights (whether to write updated weights to property in addition to returnig): {update_weights}
  ext_indices specified: {ext_indices.shape[0] > 0}
  
  Wrote results to ../test_data/2ch_setup/20230924_1027_SUVs_A655_bursts/11_FLCS_bg_corr_filters.csv/png



---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2023-09-24, 10:27:27
12 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): True
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

overall number of photons selected: 54289




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2023-09-24, 10:27:27
12 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): True
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

overall number of photons selected: 54289




---------------------------------------------
---------------------------------------------
afterpulse_correlation: Created afterpulsing prediction using biexponential model
(Called by correlation_apply_filters)
2023-09-24, 10:27:27
12 output files generated so far.

Expression:
  (A1 * exp(-t/tau1) + A2 * exp(-t/tau2)) * micro_time_gate_correction / (1 + (A1 * tau1 + A2 * tau2)) / count_rate
  Parameters used:
  channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
  A1 [GHz]: 1.3747e-07
  tau1 [ns]: 6774.349999999999
  A2 [GHz]: 7.346930000000001e-06
  tau2 [ns]: 313.849
  count rate [GHz]: 5.413536223014444e-06
  amplitude correction factor for afterpulses discarded by micro time gating: 1.0
  



---------------------------------------------
---------------------------------------------
correlation_apply_filters: Calculate correlation function applying various filters
(Called by get_correlation_uncertainty)
2023-09-24, 10:27:27
12 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((0,), ((), (0,)))
ext_indices specified: False
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
-> Actual shortest and longest lag times calculated [ns]: 1022.5245405889741, 939546643.6194469.
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): True
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

Average count rates (considering corrections and weights) [GHz]:
First correlation channel: 5.413536223014444e-06
Second correlation channel: 5.413536223014444e-06

Calculated as auto-correlation function.




---------------------------------------------
---------------------------------------------
get_Wohland_SD: Calculate correlation functions uncertainty using Wohland method.
2023-09-24, 10:27:27
12 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((0,), ((), (0,)))
minimum_window_length (shortest allowed window length) [s]: 5.0
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): True
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

  
Calculation aborted and instead switched to bootstrap method uncertainty calculation due to too-short acquisition time relative to specified minimum window length.




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2023-09-24, 10:27:27
12 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: True
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): True
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

overall number of photons selected: 34360




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2023-09-24, 10:27:27
12 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: True
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): True
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

overall number of photons selected: 34360




---------------------------------------------
---------------------------------------------
afterpulse_correlation: Created afterpulsing prediction using biexponential model
(Called by correlation_apply_filters)
2023-09-24, 10:27:27
12 output files generated so far.

Expression:
  (A1 * exp(-t/tau1) + A2 * exp(-t/tau2)) * micro_time_gate_correction / (1 + (A1 * tau1 + A2 * tau2)) / count_rate
  Parameters used:
  channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
  A1 [GHz]: 1.3747e-07
  tau1 [ns]: 6774.349999999999
  A2 [GHz]: 7.346930000000001e-06
  tau2 [ns]: 313.849
  count rate [GHz]: 3.427531429194366e-06
  amplitude correction factor for afterpulses discarded by micro time gating: 1.0
  



---------------------------------------------
---------------------------------------------
correlation_apply_filters: Calculate correlation function applying various filters
(Called by get_bootstrap_SD)
2023-09-24, 10:27:27
12 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((0,), ((), (0,)))
ext_indices specified: True
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
-> Actual shortest and longest lag times calculated [ns]: 1022.5245405889741, 939546643.6194469.
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): True
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

Average count rates (considering corrections and weights) [GHz]:
First correlation channel: 3.427531429194366e-06
Second correlation channel: 3.427531429194366e-06

Calculated as auto-correlation function.




---------------------------------------------
---------------------------------------------
get_bootstrap_SD: Calculate correlation function uncertainty via photon bootstrapping.
(Called by get_Wohland_SD)
2023-09-24, 10:27:27
12 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((0,), ((), (0,)))
n_bootstrap_reps (number of bootstrap replicates to perform) 10
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): True
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True
  
Out of 10 bootstrap replicates, 10 were successful and could be used for uncertainty estimation.




---------------------------------------------
---------------------------------------------
get_correlation_uncertainty: Calculate correlation function and uncertainty.
(Called by 03_batch_processing.py)
2023-09-24, 10:27:28
13 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((0,), ((), (0,)))
default_uncertainty_method (whether to try Wohland method SD calculation or directly use bootstrap): Wohland
minimum_window_length (shortest allowed window length) [s]: []
n_bootstrap_reps (number of bootstrap replicates to perform) 10
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: None, None
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): True
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

Results written to ../test_data/2ch_setup/20230924_1027_SUVs_A655_bursts/12_ACF_ch0_br_dt_ar_bg.csv/png



---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2023-09-24, 10:27:28
13 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 56781




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2023-09-24, 10:27:28
13 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 70616




---------------------------------------------
---------------------------------------------
correlation_apply_filters: Calculate correlation function applying various filters
(Called by get_correlation_uncertainty)
2023-09-24, 10:27:28
13 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((1,), ((), (0,)))
ext_indices specified: False
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
-> Actual shortest and longest lag times calculated [ns]: 1022.5245405889741, 939546643.6194469.
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Average count rates (considering corrections and weights) [GHz]:
First correlation channel: 5.678633889578479e-06
Second correlation channel: 7.06227149688985e-06

Calculated as two-channel cross-correlation function with assumption of time symmetry.




---------------------------------------------
---------------------------------------------
get_Wohland_SD: Calculate correlation functions uncertainty using Wohland method.
2023-09-24, 10:27:28
13 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((1,), ((), (0,)))
minimum_window_length (shortest allowed window length) [s]: 5.0
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

  
Calculation aborted and instead switched to bootstrap method uncertainty calculation due to too-short acquisition time relative to specified minimum window length.




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2023-09-24, 10:27:28
13 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: True
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 35896




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2023-09-24, 10:27:28
13 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: True
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 44558




---------------------------------------------
---------------------------------------------
correlation_apply_filters: Calculate correlation function applying various filters
(Called by get_bootstrap_SD)
2023-09-24, 10:27:28
13 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((1,), ((), (0,)))
ext_indices specified: True
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
-> Actual shortest and longest lag times calculated [ns]: 1022.5245405889741, 939546643.6194469.
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Average count rates (considering corrections and weights) [GHz]:
First correlation channel: 3.5900904181211506e-06
Second correlation channel: 4.456443080170393e-06

Calculated as two-channel cross-correlation function with assumption of time symmetry.




---------------------------------------------
---------------------------------------------
get_bootstrap_SD: Calculate correlation function uncertainty via photon bootstrapping.
(Called by get_Wohland_SD)
2023-09-24, 10:27:29
13 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((1,), ((), (0,)))
n_bootstrap_reps (number of bootstrap replicates to perform) 10
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False
  
Out of 10 bootstrap replicates, 10 were successful and could be used for uncertainty estimation.




---------------------------------------------
---------------------------------------------
get_correlation_uncertainty: Calculate correlation function and uncertainty.
(Called by 03_batch_processing.py)
2023-09-24, 10:27:29
14 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((1,), ((), (0,)))
default_uncertainty_method (whether to try Wohland method SD calculation or directly use bootstrap): Wohland
minimum_window_length (shortest allowed window length) [s]: []
n_bootstrap_reps (number of bootstrap replicates to perform) 10
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: None, None
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Results written to ../test_data/2ch_setup/20230924_1027_SUVs_A655_bursts/13_CCF_symm_ch0_ch1.csv/png



---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by get_trace_time_scale)
2023-09-24, 10:27:29
14 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 56781




---------------------------------------------
---------------------------------------------
get_trace_time_scale: Automatically estimate a reasonable time trace bin width from data.
(Called by 03_batch_processing.py)
2023-09-24, 10:27:29
14 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
min_avg_counts (criterion 1: minimum average counts per bin): 10.0
min_bin_width (criterion 2: minimum absolute bin width) [s]: 0.0001
use_tau_diff (whether to use diffusion time estimate as criterion 3): False
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False


Used only count rate and absolute minimum bin width as criteria, ignoring diffusion kinetics.

1. time_for_min_avg_counts [ns]: {time_for_min_avg_counts}
2. min_bin_width [ns]: {min_bin_width_ns}

Settled for time_trace_sampling [ns]: {time_trace_sampling}




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by get_trace_time_scale)
2023-09-24, 10:27:29
14 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 70616




---------------------------------------------
---------------------------------------------
get_trace_time_scale: Automatically estimate a reasonable time trace bin width from data.
(Called by 03_batch_processing.py)
2023-09-24, 10:27:29
14 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
min_avg_counts (criterion 1: minimum average counts per bin): 10.0
min_bin_width (criterion 2: minimum absolute bin width) [s]: 0.0001
use_tau_diff (whether to use diffusion time estimate as criterion 3): False
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False


Used only count rate and absolute minimum bin width as criteria, ignoring diffusion kinetics.

1. time_for_min_avg_counts [ns]: {time_for_min_avg_counts}
2. min_bin_width [ns]: {min_bin_width_ns}

Settled for time_trace_sampling [ns]: {time_trace_sampling}




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by get_time_trace)
2023-09-24, 10:27:29
14 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 56781




---------------------------------------------
---------------------------------------------
get_time_trace: Bin photons into time trace, applying filters.
(Called by 03_batch_processing.py)
2023-09-24, 10:27:29
15 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
time_trace_sampling (time trace bin width) [s]: 0.0015792073361590312
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Split 10.0 s long acquisition into 6332 bins with an average of 8.966203411244473 counts per bin.
Wrote results to ../test_data/2ch_setup/20230924_1027_SUVs_A655_bursts/14_Trace_ch0.csv/png



---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by get_time_trace)
2023-09-24, 10:27:29
15 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 70616




---------------------------------------------
---------------------------------------------
get_time_trace: Bin photons into time trace, applying filters.
(Called by 03_batch_processing.py)
2023-09-24, 10:27:30
16 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
time_trace_sampling (time trace bin width) [s]: 0.0015792073361590312
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Split 10.0 s long acquisition into 6332 bins with an average of 11.151610865445356 counts per bin.
Wrote results to ../test_data/2ch_setup/20230924_1027_SUVs_A655_bursts/15_Trace_ch1.csv/png



---------------------------------------------
---------------------------------------------
get_auto_threshold: Estimate a reasonable threshold photon count value from data using statistical criteria.
(Called by threshold_trace)
2023-09-24, 10:27:30
16 output files generated so far.

Parameters used:
time_trace: pre-binned photon time trace of length 6332 and an average of 8.966203411244473 counts per bin
threshold_alpha (approx. false-positive thresholding rate to be allowed by threshold): 0.02

Approximated the photon count distribution as a Gaussian with mean 7.0 and standard deviation 7.0.
Based on that, settled for a threshold of 38.




---------------------------------------------
---------------------------------------------
threshold_trace: Apply threshold to a pre-binned time trace to detect bursts.
(Called by run_burst_removal)
2023-09-24, 10:27:30
16 output files generated so far.

Parameters used:
time_trace: pre-binned photon time trace of length 6332 and an average of 8.966203411244473 counts per bin
threshold_alpha (approx. false-positive thresholding rate to be allowed in case of auto-thresholding): 0.02
-> Auto-thresholding used: True
threshold_counts (actual threshold used): 38

Thresholded the time trace, identifying 41 bins as bursts. 




---------------------------------------------
---------------------------------------------
get_auto_threshold: Estimate a reasonable threshold photon count value from data using statistical criteria.
(Called by threshold_trace)
2023-09-24, 10:27:30
16 output files generated so far.

Parameters used:
time_trace: pre-binned photon time trace of length 6332 and an average of 11.151610865445356 counts per bin
threshold_alpha (approx. false-positive thresholding rate to be allowed by threshold): 0.02

Approximated the photon count distribution as a Gaussian with mean 9.0 and standard deviation 8.0.
Based on that, settled for a threshold of 45.




---------------------------------------------
---------------------------------------------
threshold_trace: Apply threshold to a pre-binned time trace to detect bursts.
(Called by run_burst_removal)
2023-09-24, 10:27:30
16 output files generated so far.

Parameters used:
time_trace: pre-binned photon time trace of length 6332 and an average of 11.151610865445356 counts per bin
threshold_alpha (approx. false-positive thresholding rate to be allowed in case of auto-thresholding): 0.02
-> Auto-thresholding used: True
threshold_counts (actual threshold used): 45

Thresholded the time trace, identifying 45 bins as bursts. 




---------------------------------------------
---------------------------------------------
update_photons_from_bursts: Use thresholded (re-binned) time trace to update photon information.
(Called by run_burst_removal)
2023-09-24, 10:27:30
16 output files generated so far.

Parameters used:
  burst_bins: thresholded, binary, time trace with 6332 bins of which 60 are labelled as burst bins
  time_trace_sampling (time trace bin width) [s]: 0.0015792073361590312
  update_weights (whether to label the burst photons as photons to exclude from processed by setting their weights to 0): True
  update_macro_times (whether to update the macro time labled to close gaps in the photon stream created by discarding burst photons): True
  
  Out of 127397 photons included in burst annotation, 5624 were actually labelled as burst photons.
  



---------------------------------------------
---------------------------------------------
run_burst_removal: Use one or multiple time traces for burst removal.
(Called by 03_batch_processing.py)
2023-09-24, 10:27:30
17 output files generated so far.

Parameters used:
  time_trace: 2 pre-binned photon time traces of length 6332 and averages of [ 8.96620341 11.15161087] counts per bin
  time_trace_sampling (time trace bin width) [s]: 0.0015792073361590312
  threshold_alpha (approx. false-positive thresholding rate to be allowed in case of auto-thresholding): 0.02
  threshold_counts (actual threshold used): None
  update_weights (whether to label the burst photons as photons to exclude from processed by setting their weights to 0): True
  update_macro_times (whether to update the macro time labled to close gaps in the photon stream created by discarding burst photons): True
  
  Joint burst detection in 2 traces via logical OR.
  Overall detected 60 burst bins in 6332 bins.  
  Out of 127397 photons included in burst annotation, 5624 were actually labelled as burst photons.
  Wrote results to ../test_data/2ch_setup/20230924_1027_SUVs_A655_bursts/16_Burst_annotationOR_of_2_traces.csv/png



---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2023-09-24, 10:27:30
17 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 54253




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2023-09-24, 10:27:30
17 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 67520




---------------------------------------------
---------------------------------------------
correlation_apply_filters: Calculate correlation function applying various filters
(Called by get_correlation_uncertainty)
2023-09-24, 10:27:30
17 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((1,), ((), (0,)))
ext_indices specified: False
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
-> Actual shortest and longest lag times calculated [ns]: 1022.5245405889741, 939546643.6194469.
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Average count rates (considering corrections and weights) [GHz]:
First correlation channel: 5.477753266168454e-06
Second correlation channel: 6.817287490989432e-06

Calculated as two-channel cross-correlation function with assumption of time symmetry.




---------------------------------------------
---------------------------------------------
get_Wohland_SD: Calculate correlation functions uncertainty using Wohland method.
2023-09-24, 10:27:30
17 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((1,), ((), (0,)))
minimum_window_length (shortest allowed window length) [s]: 5.0
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

  
Calculation aborted and instead switched to bootstrap method uncertainty calculation due to too-short acquisition time relative to specified minimum window length.




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2023-09-24, 10:27:30
17 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: True
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 34238




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2023-09-24, 10:27:30
17 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: True
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 42721




---------------------------------------------
---------------------------------------------
correlation_apply_filters: Calculate correlation function applying various filters
(Called by get_bootstrap_SD)
2023-09-24, 10:27:30
17 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((1,), ((), (0,)))
ext_indices specified: True
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
-> Actual shortest and longest lag times calculated [ns]: 1022.5245405889741, 939546643.6194469.
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Average count rates (considering corrections and weights) [GHz]:
First correlation channel: 3.456902223417609e-06
Second correlation channel: 4.313408455310419e-06

Calculated as two-channel cross-correlation function with assumption of time symmetry.




---------------------------------------------
---------------------------------------------
get_bootstrap_SD: Calculate correlation function uncertainty via photon bootstrapping.
(Called by get_Wohland_SD)
2023-09-24, 10:27:31
17 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((1,), ((), (0,)))
n_bootstrap_reps (number of bootstrap replicates to perform) 10
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False
  
Out of 10 bootstrap replicates, 10 were successful and could be used for uncertainty estimation.




---------------------------------------------
---------------------------------------------
get_correlation_uncertainty: Calculate correlation function and uncertainty.
(Called by 03_batch_processing.py)
2023-09-24, 10:27:31
18 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((1,), ((), (0,)))
default_uncertainty_method (whether to try Wohland method SD calculation or directly use bootstrap): Wohland
minimum_window_length (shortest allowed window length) [s]: []
n_bootstrap_reps (number of bootstrap replicates to perform) 10
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: None, None
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Results written to ../test_data/2ch_setup/20230924_1027_SUVs_A655_bursts/17_CCF_symm_ch0_ch1_br.csv/png



---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by get_trace_time_scale)
2023-09-24, 10:27:31
18 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 54253




---------------------------------------------
---------------------------------------------
get_trace_time_scale: Automatically estimate a reasonable time trace bin width from data.
(Called by 03_batch_processing.py)
2023-09-24, 10:27:31
18 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
min_avg_counts (criterion 1: minimum average counts per bin): 10.0
min_bin_width (criterion 2: minimum absolute bin width) [s]: 0.0001
use_tau_diff (whether to use diffusion time estimate as criterion 3): False
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False


Used only count rate and absolute minimum bin width as criteria, ignoring diffusion kinetics.

1. time_for_min_avg_counts [ns]: {time_for_min_avg_counts}
2. min_bin_width [ns]: {min_bin_width_ns}

Settled for time_trace_sampling [ns]: {time_trace_sampling}




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by get_time_trace)
2023-09-24, 10:27:31
18 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 54253




---------------------------------------------
---------------------------------------------
get_time_trace: Bin photons into time trace, applying filters.
(Called by 03_batch_processing.py)
2023-09-24, 10:27:31
19 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
time_trace_sampling (time trace bin width) [s]: 0.0018257062872290347
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Split 10.0 s long acquisition into 5425 bins with an average of 9.999078341013824 counts per bin.
Wrote results to ../test_data/2ch_setup/20230924_1027_SUVs_A655_bursts/18_Trace_ch0_br.csv/png



---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by polynomial_undrifting_rss)
2023-09-24, 10:27:32
19 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 54253




---------------------------------------------
---------------------------------------------
polynomial_undrifting_rss: Fit time trace with a polynomial model to describe bleaching/drift trend, and correct it.
(Called by 03_batch_processing.py)
2023-09-24, 10:27:32
20 output files generated so far.

Parameters used:
time_trace: pre-binned photon time trace of length 5425 and an average of 9.999078341013824 counts per bin
time_trace_bin_centers: bin centers [ns] for time trace, binwidth is 1825706.2872290348 ns.
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
undrift_order (polynomial fit order used to describe the beaching/drift trend): 0
-> Auto-tuned undrift fit order based on residual sum of squares.
max_undrift_order (in case of auto-tuning of undrift-order, what was the maximum allowed order): 10
update_undrift_weights (whether to write the results of undrifting into the photon weights for further processing): True
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Corrected 54253 photons with bleaching/drift trend model model b(t[ns]):  
b(t[ns]) = 6.36706553708217
Wrote results to ../test_data/2ch_setup/20230924_1027_SUVs_A655_bursts/19_Trace_ch0_br_undrift_fit.csv/png



---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by get_trace_time_scale)
2023-09-24, 10:27:32
20 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 67520




---------------------------------------------
---------------------------------------------
get_trace_time_scale: Automatically estimate a reasonable time trace bin width from data.
(Called by 03_batch_processing.py)
2023-09-24, 10:27:32
20 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
min_avg_counts (criterion 1: minimum average counts per bin): 10.0
min_bin_width (criterion 2: minimum absolute bin width) [s]: 0.0001
use_tau_diff (whether to use diffusion time estimate as criterion 3): False
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False


Used only count rate and absolute minimum bin width as criteria, ignoring diffusion kinetics.

1. time_for_min_avg_counts [ns]: {time_for_min_avg_counts}
2. min_bin_width [ns]: {min_bin_width_ns}

Settled for time_trace_sampling [ns]: {time_trace_sampling}




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by get_time_trace)
2023-09-24, 10:27:32
20 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 67520




---------------------------------------------
---------------------------------------------
get_time_trace: Bin photons into time trace, applying filters.
(Called by 03_batch_processing.py)
2023-09-24, 10:27:32
21 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
time_trace_sampling (time trace bin width) [s]: 0.0014669733886409483
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Split 10.0 s long acquisition into 6751 bins with an average of 9.999111242778847 counts per bin.
Wrote results to ../test_data/2ch_setup/20230924_1027_SUVs_A655_bursts/20_Trace_ch1_br.csv/png



---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by polynomial_undrifting_rss)
2023-09-24, 10:27:32
21 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 67520




---------------------------------------------
---------------------------------------------
polynomial_undrifting_rss: Fit time trace with a polynomial model to describe bleaching/drift trend, and correct it.
(Called by 03_batch_processing.py)
2023-09-24, 10:27:33
22 output files generated so far.

Parameters used:
time_trace: pre-binned photon time trace of length 6751 and an average of 9.999111242778847 counts per bin
time_trace_bin_centers: bin centers [ns] for time trace, binwidth is 1466973.388640948 ns.
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
undrift_order (polynomial fit order used to describe the beaching/drift trend): 0
-> Auto-tuned undrift fit order based on residual sum of squares.
max_undrift_order (in case of auto-tuning of undrift-order, what was the maximum allowed order): 10
update_undrift_weights (whether to write the results of undrifting into the photon weights for further processing): True
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Corrected 67520 photons with bleaching/drift trend model model b(t[ns]):  
b(t[ns]) = 6.323071965923206
Wrote results to ../test_data/2ch_setup/20230924_1027_SUVs_A655_bursts/21_Trace_ch1_br_undrift_fit.csv/png



---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2023-09-24, 10:27:33
22 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 54253




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2023-09-24, 10:27:33
22 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 67520




---------------------------------------------
---------------------------------------------
correlation_apply_filters: Calculate correlation function applying various filters
(Called by get_correlation_uncertainty)
2023-09-24, 10:27:33
22 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((1,), ((), (0,)))
ext_indices specified: False
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
-> Actual shortest and longest lag times calculated [ns]: 1022.5245405889741, 939546643.6194469.
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Average count rates (considering corrections and weights) [GHz]:
First correlation channel: 5.477753266168454e-06
Second correlation channel: 6.817287490989432e-06

Calculated as two-channel cross-correlation function with assumption of time symmetry.




---------------------------------------------
---------------------------------------------
get_Wohland_SD: Calculate correlation functions uncertainty using Wohland method.
2023-09-24, 10:27:33
22 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((1,), ((), (0,)))
minimum_window_length (shortest allowed window length) [s]: 5.0
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

  
Calculation aborted and instead switched to bootstrap method uncertainty calculation due to too-short acquisition time relative to specified minimum window length.




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2023-09-24, 10:27:33
22 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: True
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 34262




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2023-09-24, 10:27:33
22 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: True
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 42893




---------------------------------------------
---------------------------------------------
correlation_apply_filters: Calculate correlation function applying various filters
(Called by get_bootstrap_SD)
2023-09-24, 10:27:33
22 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((1,), ((), (0,)))
ext_indices specified: True
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
-> Actual shortest and longest lag times calculated [ns]: 1022.5245405889741, 939546643.6194469.
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Average count rates (considering corrections and weights) [GHz]:
First correlation channel: 3.4593254272660235e-06
Second correlation channel: 4.330774768231779e-06

Calculated as two-channel cross-correlation function with assumption of time symmetry.




---------------------------------------------
---------------------------------------------
get_bootstrap_SD: Calculate correlation function uncertainty via photon bootstrapping.
(Called by get_Wohland_SD)
2023-09-24, 10:27:34
22 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((1,), ((), (0,)))
n_bootstrap_reps (number of bootstrap replicates to perform) 10
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False
  
Out of 10 bootstrap replicates, 10 were successful and could be used for uncertainty estimation.




---------------------------------------------
---------------------------------------------
get_correlation_uncertainty: Calculate correlation function and uncertainty.
(Called by 03_batch_processing.py)
2023-09-24, 10:27:34
23 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((1,), ((), (0,)))
default_uncertainty_method (whether to try Wohland method SD calculation or directly use bootstrap): Wohland
minimum_window_length (shortest allowed window length) [s]: []
n_bootstrap_reps (number of bootstrap replicates to perform) 10
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: None, None
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Results written to ../test_data/2ch_setup/20230924_1027_SUVs_A655_bursts/22_CCF_symm_ch0_ch1_br_dt.csv/png



---------------------------------------------
---------------------------------------------
run_mse_filter: Segment photon stream into time windows, correlate them, and remove outliers with anomalous correlation function.
(Called by 03_batch_processing.py)
2023-09-24, 10:27:34
23 output files generated so far.

Parameters_used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((1,), ((), (0,)))
minimum_window_length (shortest allowed window length) [s]: Automatically chosen as 5.0
mse_fold_threshold (mean-square error fold-change threshold for discarding segments): 2.5
ignore_amplitude_fluctuations (whether to linearly scale data to emphasise correlation function shape anomalies over amplitude fluctuations): True
update_macro_times (whether to update the macro time labled to close gaps in the photon stream created by discarding burst photons): True
update_weights (whether to label the burst photons as photons to exclude from processed by setting their weights to 0): True
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 100000.0, 1000000000.0
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True

Could not fit enough segments of specified window size into acquisition time. Skipped.




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2023-09-24, 10:27:34
23 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

overall number of photons selected: 54253




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2023-09-24, 10:27:34
23 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

overall number of photons selected: 67520




---------------------------------------------
---------------------------------------------
correlation_apply_filters: Calculate correlation function applying various filters
(Called by get_correlation_uncertainty)
2023-09-24, 10:27:34
23 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((1,), ((), (0,)))
ext_indices specified: False
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
-> Actual shortest and longest lag times calculated [ns]: 1022.5245405889741, 939546643.6194469.
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

Average count rates (considering corrections and weights) [GHz]:
First correlation channel: 5.477753266168454e-06
Second correlation channel: 6.817287490989432e-06

Calculated as two-channel cross-correlation function with assumption of time symmetry.




---------------------------------------------
---------------------------------------------
get_Wohland_SD: Calculate correlation functions uncertainty using Wohland method.
2023-09-24, 10:27:34
23 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((1,), ((), (0,)))
minimum_window_length (shortest allowed window length) [s]: 5.0
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

  
Calculation aborted and instead switched to bootstrap method uncertainty calculation due to too-short acquisition time relative to specified minimum window length.




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2023-09-24, 10:27:34
23 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: True
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

overall number of photons selected: 34278




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2023-09-24, 10:27:34
23 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: True
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

overall number of photons selected: 42792




---------------------------------------------
---------------------------------------------
correlation_apply_filters: Calculate correlation function applying various filters
(Called by get_bootstrap_SD)
2023-09-24, 10:27:34
23 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((1,), ((), (0,)))
ext_indices specified: True
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
-> Actual shortest and longest lag times calculated [ns]: 1022.5245405889741, 939546643.6194469.
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

Average count rates (considering corrections and weights) [GHz]:
First correlation channel: 3.4609408964982996e-06
Second correlation channel: 4.32057710773726e-06

Calculated as two-channel cross-correlation function with assumption of time symmetry.




---------------------------------------------
---------------------------------------------
get_bootstrap_SD: Calculate correlation function uncertainty via photon bootstrapping.
(Called by get_Wohland_SD)
2023-09-24, 10:27:35
23 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((1,), ((), (0,)))
n_bootstrap_reps (number of bootstrap replicates to perform) 10
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True
  
Out of 10 bootstrap replicates, 10 were successful and could be used for uncertainty estimation.




---------------------------------------------
---------------------------------------------
get_correlation_uncertainty: Calculate correlation function and uncertainty.
(Called by 03_batch_processing.py)
2023-09-24, 10:27:35
24 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,))), ((1,), ((), (0,)))
default_uncertainty_method (whether to try Wohland method SD calculation or directly use bootstrap): Wohland
minimum_window_length (shortest allowed window length) [s]: []
n_bootstrap_reps (number of bootstrap replicates to perform) 10
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: None, None
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

Results written to ../test_data/2ch_setup/20230924_1027_SUVs_A655_bursts/23_CCF_symm_ch0_ch1_br_dt_ar.csv/png



---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by get_tcspc_histogram)
2023-09-24, 10:27:35
24 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

overall number of photons selected: 54253




---------------------------------------------
---------------------------------------------
get_tcspc_histogram: Calculate a TCSPC histogram.
(Called by 03_batch_processing.py)
2023-09-24, 10:27:36
25 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))  
micro_times (time tags to histogram): from loaded TTTR retrieved  54253 photon time tags, of which 100.0 % were ultimately used.
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

Calculated TCSPC histogram:
has 198 bins at 250.0 ps resolution
contains 54253.0 photons
ranges over 49.74999859297391 ns

Wrote results to ../test_data/2ch_setup/20230924_1027_SUVs_A655_bursts/24_TCSPC_ch0_br_dt_ar.csv/png



---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by get_tcspc_histogram)
2023-09-24, 10:27:36
25 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

overall number of photons selected: 54253




---------------------------------------------
---------------------------------------------
get_tcspc_histogram: Calculate a TCSPC histogram.
(Called by get_background_tail_fit)
2023-09-24, 10:27:36
26 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))  
micro_times (time tags to histogram): from loaded TTTR retrieved  54253 photon time tags, of which 100.0 % were ultimately used.
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

Calculated TCSPC histogram:
has 198 bins at 250.0 ps resolution
contains 54253.0 photons
ranges over 49.74999859297391 ns

Wrote results to ../test_data/2ch_setup/20230924_1027_SUVs_A655_bursts/25_TCSPC_ch0_br_dt_ar.csv/png



---------------------------------------------
---------------------------------------------
get_background_tail_fit: Fit an exponential decay to the tail of a TCSPC histogram to determine the flat background level.
(Called by 03_batch_processing.py)
2023-09-24, 10:27:36
27 output files generated so far.

Parameters used:
  channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
  irf_peak_center (as reference point for the amplitude) [micro time channels]: 11
  fit_start (left edge of time window to include in fit) [micro time channels]: 20
  ext_indices specified: False
  use_ext_weights (use of weights for FLCS etc.): False
  use_drift_correction (use of weights for bleaching/drift correction etc.): True
  use_burst_removal (removal of photons assigned as burst photons): True
  use_mse_filter (removal of photons in segments with anomalous correlation function): True

  Included 54253.0 photons in fit.
  Fitted the following parameters (reduced chi-square: 1.3080649401136848):
  y_0 (laser-independent background) [counts per micro time channel]: 3.366986373420861
  exp_tau (1/e decay time of the exponential) [TCSPC time channels]: 12.359965766143983
  amp (exponential decay amplitude) [counts per micro time channel]: 3557.423637039994
  
  Wrote results to ../test_data/2ch_setup/20230924_1027_SUVs_A655_bursts/26_Tail_fit0_br_dt_ar.csv/png



---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by get_flcs_background_filter)
2023-09-24, 10:27:36
27 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): True
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 56781




---------------------------------------------
---------------------------------------------
get_flcs_background_filter: Use a previously determined (flat) background level to determine FLCS/fFCS filters for background suppression.
(Called by 03_batch_processing.py)
2023-09-24, 10:27:36
28 output files generated so far.

Parameters used:
  tcspc_x (TCSPC bin indices) and tcspc_y (full TCSPC histogram corresponding to those bins): 198 bins, among those 0 empty bins, 54253.0 photons
  flat_background (flat background level) [counts per TCSPC bin]: 3.366986373420861
  channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((0,), ((), (0,)))
  handle_outside (what to do with photons outside in bins tcspc_x: 'zero' (discard photons outside tcspc_x)
  update_weights (whether to write updated weights to property in addition to returnig): {update_weights}
  ext_indices specified: {ext_indices.shape[0] > 0}
  
  Wrote results to ../test_data/2ch_setup/20230924_1027_SUVs_A655_bursts/27_FLCS_bg_corr_filters.csv/png



---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by get_tcspc_histogram)
2023-09-24, 10:27:36
28 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

overall number of photons selected: 67520




---------------------------------------------
---------------------------------------------
get_tcspc_histogram: Calculate a TCSPC histogram.
(Called by 03_batch_processing.py)
2023-09-24, 10:27:37
29 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))  
micro_times (time tags to histogram): from loaded TTTR retrieved  67520 photon time tags, of which 100.0 % were ultimately used.
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

Calculated TCSPC histogram:
has 200 bins at 250.0 ps resolution
contains 67520.0 photons
ranges over 49.74999859297391 ns

Wrote results to ../test_data/2ch_setup/20230924_1027_SUVs_A655_bursts/28_TCSPC_ch1_br_dt_ar.csv/png



---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by get_tcspc_histogram)
2023-09-24, 10:27:37
29 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

overall number of photons selected: 67520




---------------------------------------------
---------------------------------------------
get_tcspc_histogram: Calculate a TCSPC histogram.
(Called by get_background_tail_fit)
2023-09-24, 10:27:37
30 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))  
micro_times (time tags to histogram): from loaded TTTR retrieved  67520 photon time tags, of which 100.0 % were ultimately used.
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

Calculated TCSPC histogram:
has 200 bins at 250.0 ps resolution
contains 67520.0 photons
ranges over 49.74999859297391 ns

Wrote results to ../test_data/2ch_setup/20230924_1027_SUVs_A655_bursts/29_TCSPC_ch1_br_dt_ar.csv/png



---------------------------------------------
---------------------------------------------
Error: Logging traceback.
(Called by 03_batch_processing.py)
2023-09-24, 10:27:37
30 output files generated so far.

Traceback (most recent call last):
  File "/fs/pool/pool-schwille-spt/_Software/FCS_cleaner_dev/FCS_Fixer/scripts/03_batch_processing.py", line 292, in <module>
calling_function = script_name)
  File "/fs/gpfs41/lv02/fileset02/pool/pool-schwille-spt/_Software/FCS_cleaner_dev/FCS_Fixer/functions/FCS_Fixer.py", line 6501, in get_background_tail_fit
'y_0': np.min(tcspc_y_crop),
  File "<__array_function__ internals>", line 6, in amin
  File "/fs/home/krohn/.conda/envs/tttr/lib/python3.7/site-packages/numpy/core/fromnumeric.py", line 2859, in amin
keepdims=keepdims, initial=initial, where=where)
  File "/fs/home/krohn/.conda/envs/tttr/lib/python3.7/site-packages/numpy/core/fromnumeric.py", line 87, in _wrapreduction
return ufunc.reduce(obj, axis, dtype, out, **passkwargs)
ValueError: zero-size array to reduction operation minimum which has no identity




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2023-09-24, 10:27:37
30 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 70616




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2023-09-24, 10:27:37
30 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 70616




---------------------------------------------
---------------------------------------------
afterpulse_correlation: Created afterpulsing prediction using biexponential model
(Called by correlation_apply_filters)
2023-09-24, 10:27:37
30 output files generated so far.

Expression:
  (A1 * exp(-t/tau1) + A2 * exp(-t/tau2)) * micro_time_gate_correction / (1 + (A1 * tau1 + A2 * tau2)) / count_rate
  Parameters used:
  channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
  A1 [GHz]: 3.0646300000000004e-07
  tau1 [ns]: 7437.91
  A2 [GHz]: 4.1057500000000005e-06
  tau2 [ns]: 310.915
  count rate [GHz]: 7.062664369065276e-06
  amplitude correction factor for afterpulses discarded by micro time gating: 1.0
  



---------------------------------------------
---------------------------------------------
correlation_apply_filters: Calculate correlation function applying various filters
(Called by get_correlation_uncertainty)
2023-09-24, 10:27:37
30 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,))), ((1,), ((), (0,)))
ext_indices specified: False
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
-> Actual shortest and longest lag times calculated [ns]: 1022.5245405889741, 939546643.6194469.
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Average count rates (considering corrections and weights) [GHz]:
First correlation channel: 7.062664369065276e-06
Second correlation channel: 7.062664369065276e-06

Calculated as auto-correlation function.




---------------------------------------------
---------------------------------------------
get_Wohland_SD: Calculate correlation functions uncertainty using Wohland method.
2023-09-24, 10:27:37
30 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,))), ((1,), ((), (0,)))
minimum_window_length (shortest allowed window length) [s]: 5.0
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

  
Calculation aborted and instead switched to bootstrap method uncertainty calculation due to too-short acquisition time relative to specified minimum window length.




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2023-09-24, 10:27:37
30 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: True
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 44686




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2023-09-24, 10:27:37
30 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: True
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 44686




---------------------------------------------
---------------------------------------------
afterpulse_correlation: Created afterpulsing prediction using biexponential model
(Called by correlation_apply_filters)
2023-09-24, 10:27:37
30 output files generated so far.

Expression:
  (A1 * exp(-t/tau1) + A2 * exp(-t/tau2)) * micro_time_gate_correction / (1 + (A1 * tau1 + A2 * tau2)) / count_rate
  Parameters used:
  channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
  A1 [GHz]: 3.0646300000000004e-07
  tau1 [ns]: 7437.91
  A2 [GHz]: 4.1057500000000005e-06
  tau2 [ns]: 310.915
  count rate [GHz]: 4.46930319469481e-06
  amplitude correction factor for afterpulses discarded by micro time gating: 1.0
  



---------------------------------------------
---------------------------------------------
correlation_apply_filters: Calculate correlation function applying various filters
(Called by get_bootstrap_SD)
2023-09-24, 10:27:37
30 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,))), ((1,), ((), (0,)))
ext_indices specified: True
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
-> Actual shortest and longest lag times calculated [ns]: 1022.5245405889741, 939546643.6194469.
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Average count rates (considering corrections and weights) [GHz]:
First correlation channel: 4.46930319469481e-06
Second correlation channel: 4.46930319469481e-06

Calculated as auto-correlation function.




---------------------------------------------
---------------------------------------------
get_bootstrap_SD: Calculate correlation function uncertainty via photon bootstrapping.
(Called by get_Wohland_SD)
2023-09-24, 10:27:37
30 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,))), ((1,), ((), (0,)))
n_bootstrap_reps (number of bootstrap replicates to perform) 10
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False
  
Out of 10 bootstrap replicates, 10 were successful and could be used for uncertainty estimation.




---------------------------------------------
---------------------------------------------
get_correlation_uncertainty: Calculate correlation function and uncertainty.
(Called by 03_batch_processing.py)
2023-09-24, 10:27:38
31 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,))), ((1,), ((), (0,)))
default_uncertainty_method (whether to try Wohland method SD calculation or directly use bootstrap): Wohland
minimum_window_length (shortest allowed window length) [s]: []
n_bootstrap_reps (number of bootstrap replicates to perform) 10
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: None, None
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Results written to ../test_data/2ch_setup/20230924_1027_SUVs_A655_bursts/30_ACF_ch1.csv/png



---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by get_trace_time_scale)
2023-09-24, 10:27:38
31 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 70616




---------------------------------------------
---------------------------------------------
get_trace_time_scale: Automatically estimate a reasonable time trace bin width from data.
(Called by 03_batch_processing.py)
2023-09-24, 10:27:38
31 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
min_avg_counts (criterion 1: minimum average counts per bin): 10.0
min_bin_width (criterion 2: minimum absolute bin width) [s]: 0.0001
use_tau_diff (whether to use diffusion time estimate as criterion 3): False
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False


Used only count rate and absolute minimum bin width as criteria, ignoring diffusion kinetics.

1. time_for_min_avg_counts [ns]: {time_for_min_avg_counts}
2. min_bin_width [ns]: {min_bin_width_ns}

Settled for time_trace_sampling [ns]: {time_trace_sampling}




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by get_time_trace)
2023-09-24, 10:27:38
31 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 70616




---------------------------------------------
---------------------------------------------
get_time_trace: Bin photons into time trace, applying filters.
(Called by 03_batch_processing.py)
2023-09-24, 10:27:38
32 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
time_trace_sampling (time trace bin width) [s]: 0.0014160843216417098
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Split 10.0 s long acquisition into 7061 bins with an average of 9.99915026200255 counts per bin.
Wrote results to ../test_data/2ch_setup/20230924_1027_SUVs_A655_bursts/31_Trace_ch1.csv/png



---------------------------------------------
---------------------------------------------
get_auto_threshold: Estimate a reasonable threshold photon count value from data using statistical criteria.
(Called by threshold_trace)
2023-09-24, 10:27:38
32 output files generated so far.

Parameters used:
time_trace: pre-binned photon time trace of length 7061 and an average of 9.99915026200255 counts per bin
threshold_alpha (approx. false-positive thresholding rate to be allowed by threshold): 0.02

Approximated the photon count distribution as a Gaussian with mean 8.0 and standard deviation 8.0.
Based on that, settled for a threshold of 44.




---------------------------------------------
---------------------------------------------
threshold_trace: Apply threshold to a pre-binned time trace to detect bursts.
(Called by run_burst_removal)
2023-09-24, 10:27:38
32 output files generated so far.

Parameters used:
time_trace: pre-binned photon time trace of length 7061 and an average of 9.99915026200255 counts per bin
threshold_alpha (approx. false-positive thresholding rate to be allowed in case of auto-thresholding): 0.02
-> Auto-thresholding used: True
threshold_counts (actual threshold used): 44

Thresholded the time trace, identifying 38 bins as bursts. 




---------------------------------------------
---------------------------------------------
update_photons_from_bursts: Use thresholded (re-binned) time trace to update photon information.
(Called by run_burst_removal)
2023-09-24, 10:27:38
32 output files generated so far.

Parameters used:
  burst_bins: thresholded, binary, time trace with 7061 bins of which 38 are labelled as burst bins
  time_trace_sampling (time trace bin width) [s]: 0.0014160843216417098
  update_weights (whether to label the burst photons as photons to exclude from processed by setting their weights to 0): True
  update_macro_times (whether to update the macro time labled to close gaps in the photon stream created by discarding burst photons): True
  
  Out of 127397 photons included in burst annotation, 3590 were actually labelled as burst photons.
  



---------------------------------------------
---------------------------------------------
run_burst_removal: Use one or multiple time traces for burst removal.
(Called by 03_batch_processing.py)
2023-09-24, 10:27:38
33 output files generated so far.

Parameters used:
  time_trace: 1 pre-binned photon time traces of length 7061 and averages of 9.99915026200255 counts per bin
  time_trace_sampling (time trace bin width) [s]: 0.0014160843216417098
  threshold_alpha (approx. false-positive thresholding rate to be allowed in case of auto-thresholding): 0.02
  threshold_counts (actual threshold used): None
  update_weights (whether to label the burst photons as photons to exclude from processed by setting their weights to 0): True
  update_macro_times (whether to update the macro time labled to close gaps in the photon stream created by discarding burst photons): True
  
  Burst detection on a single trace.
  Overall detected 38 burst bins in 7061 bins.  
  Out of 127397 photons included in burst annotation, 3590 were actually labelled as burst photons.
  Wrote results to ../test_data/2ch_setup/20230924_1027_SUVs_A655_bursts/32_Burst_annotation_single_trace.csv/png



---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2023-09-24, 10:27:38
33 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 68554




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2023-09-24, 10:27:39
33 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 68554




---------------------------------------------
---------------------------------------------
afterpulse_correlation: Created afterpulsing prediction using biexponential model
(Called by correlation_apply_filters)
2023-09-24, 10:27:39
33 output files generated so far.

Expression:
  (A1 * exp(-t/tau1) + A2 * exp(-t/tau2)) * micro_time_gate_correction / (1 + (A1 * tau1 + A2 * tau2)) / count_rate
  Parameters used:
  channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
  A1 [GHz]: 3.0646300000000004e-07
  tau1 [ns]: 7437.91
  A2 [GHz]: 4.1057500000000005e-06
  tau2 [ns]: 310.915
  count rate [GHz]: 6.8935219187989615e-06
  amplitude correction factor for afterpulses discarded by micro time gating: 1.0
  



---------------------------------------------
---------------------------------------------
correlation_apply_filters: Calculate correlation function applying various filters
(Called by get_correlation_uncertainty)
2023-09-24, 10:27:39
33 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,))), ((1,), ((), (0,)))
ext_indices specified: False
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
-> Actual shortest and longest lag times calculated [ns]: 1022.5245405889741, 939546643.6194469.
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Average count rates (considering corrections and weights) [GHz]:
First correlation channel: 6.8935219187989615e-06
Second correlation channel: 6.8935219187989615e-06

Calculated as auto-correlation function.




---------------------------------------------
---------------------------------------------
get_Wohland_SD: Calculate correlation functions uncertainty using Wohland method.
2023-09-24, 10:27:39
33 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,))), ((1,), ((), (0,)))
minimum_window_length (shortest allowed window length) [s]: 5.0
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

  
Calculation aborted and instead switched to bootstrap method uncertainty calculation due to too-short acquisition time relative to specified minimum window length.




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2023-09-24, 10:27:39
33 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: True
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 43221




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2023-09-24, 10:27:39
33 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: True
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 43221




---------------------------------------------
---------------------------------------------
afterpulse_correlation: Created afterpulsing prediction using biexponential model
(Called by correlation_apply_filters)
2023-09-24, 10:27:39
33 output files generated so far.

Expression:
  (A1 * exp(-t/tau1) + A2 * exp(-t/tau2)) * micro_time_gate_correction / (1 + (A1 * tau1 + A2 * tau2)) / count_rate
  Parameters used:
  channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
  A1 [GHz]: 3.0646300000000004e-07
  tau1 [ns]: 7437.91
  A2 [GHz]: 4.1057500000000005e-06
  tau2 [ns]: 310.915
  count rate [GHz]: 4.346134592473231e-06
  amplitude correction factor for afterpulses discarded by micro time gating: 1.0
  



---------------------------------------------
---------------------------------------------
correlation_apply_filters: Calculate correlation function applying various filters
(Called by get_bootstrap_SD)
2023-09-24, 10:27:39
33 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,))), ((1,), ((), (0,)))
ext_indices specified: True
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
-> Actual shortest and longest lag times calculated [ns]: 1022.5245405889741, 939546643.6194469.
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Average count rates (considering corrections and weights) [GHz]:
First correlation channel: 4.346134592473231e-06
Second correlation channel: 4.346134592473231e-06

Calculated as auto-correlation function.




---------------------------------------------
---------------------------------------------
get_bootstrap_SD: Calculate correlation function uncertainty via photon bootstrapping.
(Called by get_Wohland_SD)
2023-09-24, 10:27:39
33 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,))), ((1,), ((), (0,)))
n_bootstrap_reps (number of bootstrap replicates to perform) 10
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False
  
Out of 10 bootstrap replicates, 10 were successful and could be used for uncertainty estimation.




---------------------------------------------
---------------------------------------------
get_correlation_uncertainty: Calculate correlation function and uncertainty.
(Called by 03_batch_processing.py)
2023-09-24, 10:27:39
34 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,))), ((1,), ((), (0,)))
default_uncertainty_method (whether to try Wohland method SD calculation or directly use bootstrap): Wohland
minimum_window_length (shortest allowed window length) [s]: []
n_bootstrap_reps (number of bootstrap replicates to perform) 10
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: None, None
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Results written to ../test_data/2ch_setup/20230924_1027_SUVs_A655_bursts/33_ACF_ch1_br.csv/png



---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by get_trace_time_scale)
2023-09-24, 10:27:39
34 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 68554




---------------------------------------------
---------------------------------------------
get_trace_time_scale: Automatically estimate a reasonable time trace bin width from data.
(Called by 03_batch_processing.py)
2023-09-24, 10:27:39
34 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
min_avg_counts (criterion 1: minimum average counts per bin): 10.0
min_bin_width (criterion 2: minimum absolute bin width) [s]: 0.0001
use_tau_diff (whether to use diffusion time estimate as criterion 3): False
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False


Used only count rate and absolute minimum bin width as criteria, ignoring diffusion kinetics.

1. time_for_min_avg_counts [ns]: {time_for_min_avg_counts}
2. min_bin_width [ns]: {min_bin_width_ns}

Settled for time_trace_sampling [ns]: {time_trace_sampling}




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by get_time_trace)
2023-09-24, 10:27:39
34 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 68554




---------------------------------------------
---------------------------------------------
get_time_trace: Bin photons into time trace, applying filters.
(Called by 03_batch_processing.py)
2023-09-24, 10:27:40
35 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
time_trace_sampling (time trace bin width) [s]: 0.0014508310243965504
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Split 10.0 s long acquisition into 6855 bins with an average of 9.999416484318017 counts per bin.
Wrote results to ../test_data/2ch_setup/20230924_1027_SUVs_A655_bursts/34_Trace_ch1_br.csv/png



---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by polynomial_undrifting_rss)
2023-09-24, 10:27:40
35 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 68554




---------------------------------------------
---------------------------------------------
polynomial_undrifting_rss: Fit time trace with a polynomial model to describe bleaching/drift trend, and correct it.
(Called by 03_batch_processing.py)
2023-09-24, 10:27:40
36 output files generated so far.

Parameters used:
time_trace: pre-binned photon time trace of length 6855 and an average of 9.999416484318017 counts per bin
time_trace_bin_centers: bin centers [ns] for time trace, binwidth is 1450831.024396551 ns.
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
undrift_order (polynomial fit order used to describe the beaching/drift trend): 0
-> Auto-tuned undrift fit order based on residual sum of squares.
max_undrift_order (in case of auto-tuning of undrift-order, what was the maximum allowed order): 10
update_undrift_weights (whether to write the results of undrifting into the photon weights for further processing): True
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Corrected 68554 photons with bleaching/drift trend model model b(t[ns]):  
b(t[ns]) = 6.255574987914694
Wrote results to ../test_data/2ch_setup/20230924_1027_SUVs_A655_bursts/35_Trace_ch1_br_undrift_fit.csv/png



---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2023-09-24, 10:27:40
36 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 68554




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2023-09-24, 10:27:40
36 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 68554




---------------------------------------------
---------------------------------------------
afterpulse_correlation: Created afterpulsing prediction using biexponential model
(Called by correlation_apply_filters)
2023-09-24, 10:27:40
36 output files generated so far.

Expression:
  (A1 * exp(-t/tau1) + A2 * exp(-t/tau2)) * micro_time_gate_correction / (1 + (A1 * tau1 + A2 * tau2)) / count_rate
  Parameters used:
  channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
  A1 [GHz]: 3.0646300000000004e-07
  tau1 [ns]: 7437.91
  A2 [GHz]: 4.1057500000000005e-06
  tau2 [ns]: 310.915
  count rate [GHz]: 6.8935219187989615e-06
  amplitude correction factor for afterpulses discarded by micro time gating: 1.0
  



---------------------------------------------
---------------------------------------------
correlation_apply_filters: Calculate correlation function applying various filters
(Called by get_correlation_uncertainty)
2023-09-24, 10:27:40
36 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,))), ((1,), ((), (0,)))
ext_indices specified: False
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
-> Actual shortest and longest lag times calculated [ns]: 1022.5245405889741, 939546643.6194469.
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Average count rates (considering corrections and weights) [GHz]:
First correlation channel: 6.8935219187989615e-06
Second correlation channel: 6.8935219187989615e-06

Calculated as auto-correlation function.




---------------------------------------------
---------------------------------------------
get_Wohland_SD: Calculate correlation functions uncertainty using Wohland method.
2023-09-24, 10:27:40
36 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,))), ((1,), ((), (0,)))
minimum_window_length (shortest allowed window length) [s]: 5.0
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

  
Calculation aborted and instead switched to bootstrap method uncertainty calculation due to too-short acquisition time relative to specified minimum window length.




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2023-09-24, 10:27:40
36 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: True
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 43318




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2023-09-24, 10:27:40
36 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: True
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 43318




---------------------------------------------
---------------------------------------------
afterpulse_correlation: Created afterpulsing prediction using biexponential model
(Called by correlation_apply_filters)
2023-09-24, 10:27:40
36 output files generated so far.

Expression:
  (A1 * exp(-t/tau1) + A2 * exp(-t/tau2)) * micro_time_gate_correction / (1 + (A1 * tau1 + A2 * tau2)) / count_rate
  Parameters used:
  channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
  A1 [GHz]: 3.0646300000000004e-07
  tau1 [ns]: 7437.91
  A2 [GHz]: 4.1057500000000005e-06
  tau2 [ns]: 310.915
  count rate [GHz]: 4.355917595742059e-06
  amplitude correction factor for afterpulses discarded by micro time gating: 1.0
  



---------------------------------------------
---------------------------------------------
correlation_apply_filters: Calculate correlation function applying various filters
(Called by get_bootstrap_SD)
2023-09-24, 10:27:40
36 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,))), ((1,), ((), (0,)))
ext_indices specified: True
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
-> Actual shortest and longest lag times calculated [ns]: 1022.5245405889741, 939546643.6194469.
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Average count rates (considering corrections and weights) [GHz]:
First correlation channel: 4.355917595742059e-06
Second correlation channel: 4.355917595742059e-06

Calculated as auto-correlation function.




---------------------------------------------
---------------------------------------------
get_bootstrap_SD: Calculate correlation function uncertainty via photon bootstrapping.
(Called by get_Wohland_SD)
2023-09-24, 10:27:41
36 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,))), ((1,), ((), (0,)))
n_bootstrap_reps (number of bootstrap replicates to perform) 10
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False
  
Out of 10 bootstrap replicates, 10 were successful and could be used for uncertainty estimation.




---------------------------------------------
---------------------------------------------
get_correlation_uncertainty: Calculate correlation function and uncertainty.
(Called by 03_batch_processing.py)
2023-09-24, 10:27:41
37 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,))), ((1,), ((), (0,)))
default_uncertainty_method (whether to try Wohland method SD calculation or directly use bootstrap): Wohland
minimum_window_length (shortest allowed window length) [s]: []
n_bootstrap_reps (number of bootstrap replicates to perform) 10
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: None, None
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): False

Results written to ../test_data/2ch_setup/20230924_1027_SUVs_A655_bursts/36_ACF_ch1_br_dt.csv/png



---------------------------------------------
---------------------------------------------
run_mse_filter: Segment photon stream into time windows, correlate them, and remove outliers with anomalous correlation function.
(Called by 03_batch_processing.py)
2023-09-24, 10:27:41
37 output files generated so far.

Parameters_used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,))), ((1,), ((), (0,)))
minimum_window_length (shortest allowed window length) [s]: Automatically chosen as 5.0
mse_fold_threshold (mean-square error fold-change threshold for discarding segments): 2.5
ignore_amplitude_fluctuations (whether to linearly scale data to emphasise correlation function shape anomalies over amplitude fluctuations): True
update_macro_times (whether to update the macro time labled to close gaps in the photon stream created by discarding burst photons): True
update_weights (whether to label the burst photons as photons to exclude from processed by setting their weights to 0): True
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 100000.0, 1000000000.0
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True

Could not fit enough segments of specified window size into acquisition time. Skipped.




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2023-09-24, 10:27:41
37 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

overall number of photons selected: 68554




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2023-09-24, 10:27:41
37 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

overall number of photons selected: 68554




---------------------------------------------
---------------------------------------------
afterpulse_correlation: Created afterpulsing prediction using biexponential model
(Called by correlation_apply_filters)
2023-09-24, 10:27:41
37 output files generated so far.

Expression:
  (A1 * exp(-t/tau1) + A2 * exp(-t/tau2)) * micro_time_gate_correction / (1 + (A1 * tau1 + A2 * tau2)) / count_rate
  Parameters used:
  channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
  A1 [GHz]: 3.0646300000000004e-07
  tau1 [ns]: 7437.91
  A2 [GHz]: 4.1057500000000005e-06
  tau2 [ns]: 310.915
  count rate [GHz]: 6.8935219187989615e-06
  amplitude correction factor for afterpulses discarded by micro time gating: 1.0
  



---------------------------------------------
---------------------------------------------
correlation_apply_filters: Calculate correlation function applying various filters
(Called by get_correlation_uncertainty)
2023-09-24, 10:27:41
37 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,))), ((1,), ((), (0,)))
ext_indices specified: False
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
-> Actual shortest and longest lag times calculated [ns]: 1022.5245405889741, 939546643.6194469.
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

Average count rates (considering corrections and weights) [GHz]:
First correlation channel: 6.8935219187989615e-06
Second correlation channel: 6.8935219187989615e-06

Calculated as auto-correlation function.




---------------------------------------------
---------------------------------------------
get_Wohland_SD: Calculate correlation functions uncertainty using Wohland method.
2023-09-24, 10:27:41
37 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,))), ((1,), ((), (0,)))
minimum_window_length (shortest allowed window length) [s]: 5.0
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

  
Calculation aborted and instead switched to bootstrap method uncertainty calculation due to too-short acquisition time relative to specified minimum window length.




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2023-09-24, 10:27:41
37 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: True
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

overall number of photons selected: 43236




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2023-09-24, 10:27:41
37 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: True
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

overall number of photons selected: 43236




---------------------------------------------
---------------------------------------------
afterpulse_correlation: Created afterpulsing prediction using biexponential model
(Called by correlation_apply_filters)
2023-09-24, 10:27:41
37 output files generated so far.

Expression:
  (A1 * exp(-t/tau1) + A2 * exp(-t/tau2)) * micro_time_gate_correction / (1 + (A1 * tau1 + A2 * tau2)) / count_rate
  Parameters used:
  channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
  A1 [GHz]: 3.0646300000000004e-07
  tau1 [ns]: 7437.91
  A2 [GHz]: 4.1057500000000005e-06
  tau2 [ns]: 310.915
  count rate [GHz]: 4.347714678227881e-06
  amplitude correction factor for afterpulses discarded by micro time gating: 1.0
  



---------------------------------------------
---------------------------------------------
correlation_apply_filters: Calculate correlation function applying various filters
(Called by get_bootstrap_SD)
2023-09-24, 10:27:41
37 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,))), ((1,), ((), (0,)))
ext_indices specified: True
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
-> Actual shortest and longest lag times calculated [ns]: 1022.5245405889741, 939546643.6194469.
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

Average count rates (considering corrections and weights) [GHz]:
First correlation channel: 4.347714678227881e-06
Second correlation channel: 4.347714678227881e-06

Calculated as auto-correlation function.




---------------------------------------------
---------------------------------------------
get_bootstrap_SD: Calculate correlation function uncertainty via photon bootstrapping.
(Called by get_Wohland_SD)
2023-09-24, 10:27:42
37 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,))), ((1,), ((), (0,)))
n_bootstrap_reps (number of bootstrap replicates to perform) 10
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True
  
Out of 10 bootstrap replicates, 10 were successful and could be used for uncertainty estimation.




---------------------------------------------
---------------------------------------------
get_correlation_uncertainty: Calculate correlation function and uncertainty.
(Called by 03_batch_processing.py)
2023-09-24, 10:27:42
38 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,))), ((1,), ((), (0,)))
default_uncertainty_method (whether to try Wohland method SD calculation or directly use bootstrap): Wohland
minimum_window_length (shortest allowed window length) [s]: []
n_bootstrap_reps (number of bootstrap replicates to perform) 10
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: None, None
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

Results written to ../test_data/2ch_setup/20230924_1027_SUVs_A655_bursts/37_ACF_ch1_br_dt_ar.csv/png



---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by get_tcspc_histogram)
2023-09-24, 10:27:42
38 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

overall number of photons selected: 68554




---------------------------------------------
---------------------------------------------
get_tcspc_histogram: Calculate a TCSPC histogram.
(Called by 03_batch_processing.py)
2023-09-24, 10:27:42
39 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))  
micro_times (time tags to histogram): from loaded TTTR retrieved  68554 photon time tags, of which 100.0 % were ultimately used.
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

Calculated TCSPC histogram:
has 200 bins at 250.0 ps resolution
contains 68554.0 photons
ranges over 49.74999859297391 ns

Wrote results to ../test_data/2ch_setup/20230924_1027_SUVs_A655_bursts/38_TCSPC_ch1_br_dt_ar.csv/png



---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by get_tcspc_histogram)
2023-09-24, 10:27:42
39 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): False
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

overall number of photons selected: 68554




---------------------------------------------
---------------------------------------------
get_tcspc_histogram: Calculate a TCSPC histogram.
(Called by get_background_tail_fit)
2023-09-24, 10:27:43
40 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))  
micro_times (time tags to histogram): from loaded TTTR retrieved  68554 photon time tags, of which 100.0 % were ultimately used.
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

Calculated TCSPC histogram:
has 200 bins at 250.0 ps resolution
contains 68554.0 photons
ranges over 49.74999859297391 ns

Wrote results to ../test_data/2ch_setup/20230924_1027_SUVs_A655_bursts/39_TCSPC_ch1_br_dt_ar.csv/png



---------------------------------------------
---------------------------------------------
get_background_tail_fit: Fit an exponential decay to the tail of a TCSPC histogram to determine the flat background level.
(Called by 03_batch_processing.py)
2023-09-24, 10:27:43
41 output files generated so far.

Parameters used:
  channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
  irf_peak_center (as reference point for the amplitude) [micro time channels]: 11
  fit_start (left edge of time window to include in fit) [micro time channels]: 20
  ext_indices specified: False
  use_ext_weights (use of weights for FLCS etc.): False
  use_drift_correction (use of weights for bleaching/drift correction etc.): True
  use_burst_removal (removal of photons assigned as burst photons): True
  use_mse_filter (removal of photons in segments with anomalous correlation function): True

  Included 68554.0 photons in fit.
  Fitted the following parameters (reduced chi-square: 1.4626300169312247):
  y_0 (laser-independent background) [counts per micro time channel]: 5.36520917510859
  exp_tau (1/e decay time of the exponential) [TCSPC time channels]: 13.25850738984623
  amp (exponential decay amplitude) [counts per micro time channel]: 4349.090692282285
  
  Wrote results to ../test_data/2ch_setup/20230924_1027_SUVs_A655_bursts/40_Tail_fit1_br_dt_ar.csv/png



---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by get_flcs_background_filter)
2023-09-24, 10:27:43
41 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): False
use_flcs_bg_corr (use of FLCS-based background subtraction): True
use_burst_removal (removal of photons assigned as burst photons): False
use_mse_filter (removal of photons in segments with anomalous correlation function): False

overall number of photons selected: 70616




---------------------------------------------
---------------------------------------------
get_flcs_background_filter: Use a previously determined (flat) background level to determine FLCS/fFCS filters for background suppression.
(Called by 03_batch_processing.py)
2023-09-24, 10:27:43
42 output files generated so far.

Parameters used:
  tcspc_x (TCSPC bin indices) and tcspc_y (full TCSPC histogram corresponding to those bins): 200 bins, among those 0 empty bins, 68554.0 photons
  flat_background (flat background level) [counts per TCSPC bin]: 5.36520917510859
  channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
  handle_outside (what to do with photons outside in bins tcspc_x: irrelavant, full histogram was covered
  update_weights (whether to write updated weights to property in addition to returnig): {update_weights}
  ext_indices specified: {ext_indices.shape[0] > 0}
  
  Wrote results to ../test_data/2ch_setup/20230924_1027_SUVs_A655_bursts/41_FLCS_bg_corr_filters.csv/png



---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2023-09-24, 10:27:43
42 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): True
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

overall number of photons selected: 68554




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2023-09-24, 10:27:43
42 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: False
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): True
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

overall number of photons selected: 68554




---------------------------------------------
---------------------------------------------
afterpulse_correlation: Created afterpulsing prediction using biexponential model
(Called by correlation_apply_filters)
2023-09-24, 10:27:43
42 output files generated so far.

Expression:
  (A1 * exp(-t/tau1) + A2 * exp(-t/tau2)) * micro_time_gate_correction / (1 + (A1 * tau1 + A2 * tau2)) / count_rate
  Parameters used:
  channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
  A1 [GHz]: 3.0646300000000004e-07
  tau1 [ns]: 7437.91
  A2 [GHz]: 4.1057500000000005e-06
  tau2 [ns]: 310.915
  count rate [GHz]: 6.785696831963329e-06
  amplitude correction factor for afterpulses discarded by micro time gating: 1.0
  



---------------------------------------------
---------------------------------------------
correlation_apply_filters: Calculate correlation function applying various filters
(Called by get_correlation_uncertainty)
2023-09-24, 10:27:43
42 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,))), ((1,), ((), (0,)))
ext_indices specified: False
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
-> Actual shortest and longest lag times calculated [ns]: 1022.5245405889741, 939546643.6194469.
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): True
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

Average count rates (considering corrections and weights) [GHz]:
First correlation channel: 6.785696831963329e-06
Second correlation channel: 6.785696831963329e-06

Calculated as auto-correlation function.




---------------------------------------------
---------------------------------------------
get_Wohland_SD: Calculate correlation functions uncertainty using Wohland method.
2023-09-24, 10:27:43
42 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,))), ((1,), ((), (0,)))
minimum_window_length (shortest allowed window length) [s]: 5.0
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): True
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

  
Calculation aborted and instead switched to bootstrap method uncertainty calculation due to too-short acquisition time relative to specified minimum window length.




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2023-09-24, 10:27:43
42 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: True
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): True
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

overall number of photons selected: 43417




---------------------------------------------
---------------------------------------------
select_photons: Get photons for processing and applying corrections.
(Called by correlation_apply_filters)
2023-09-24, 10:27:43
42 output files generated so far.

Parameters used:
channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
ext_indices specified: True
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): True
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

overall number of photons selected: 43417




---------------------------------------------
---------------------------------------------
afterpulse_correlation: Created afterpulsing prediction using biexponential model
(Called by correlation_apply_filters)
2023-09-24, 10:27:43
42 output files generated so far.

Expression:
  (A1 * exp(-t/tau1) + A2 * exp(-t/tau2)) * micro_time_gate_correction / (1 + (A1 * tau1 + A2 * tau2)) / count_rate
  Parameters used:
  channels_spec ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,)))
  A1 [GHz]: 3.0646300000000004e-07
  tau1 [ns]: 7437.91
  A2 [GHz]: 4.1057500000000005e-06
  tau2 [ns]: 310.915
  count rate [GHz]: 4.2979353784206495e-06
  amplitude correction factor for afterpulses discarded by micro time gating: 1.0
  



---------------------------------------------
---------------------------------------------
correlation_apply_filters: Calculate correlation function applying various filters
(Called by get_bootstrap_SD)
2023-09-24, 10:27:43
42 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,))), ((1,), ((), (0,)))
ext_indices specified: True
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
-> Actual shortest and longest lag times calculated [ns]: 1022.5245405889741, 939546643.6194469.
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): True
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

Average count rates (considering corrections and weights) [GHz]:
First correlation channel: 4.2979353784206495e-06
Second correlation channel: 4.2979353784206495e-06

Calculated as auto-correlation function.




---------------------------------------------
---------------------------------------------
get_bootstrap_SD: Calculate correlation function uncertainty via photon bootstrapping.
(Called by get_Wohland_SD)
2023-09-24, 10:27:44
42 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,))), ((1,), ((), (0,)))
n_bootstrap_reps (number of bootstrap replicates to perform) 10
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: 1000.0, 1000000000.0
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): True
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True
  
Out of 10 bootstrap replicates, 10 were successful and could be used for uncertainty estimation.




---------------------------------------------
---------------------------------------------
get_correlation_uncertainty: Calculate correlation function and uncertainty.
(Called by 03_batch_processing.py)
2023-09-24, 10:27:44
43 output files generated so far.

Parameters used:
channels_spec_1, channels_spec_2 ((one_or_multiple_channels), ((PIE_gate_edges), (which_gates_to_use))): ((1,), ((), (0,))), ((1,), ((), (0,)))
default_uncertainty_method (whether to try Wohland method SD calculation or directly use bootstrap): Wohland
minimum_window_length (shortest allowed window length) [s]: []
n_bootstrap_reps (number of bootstrap replicates to perform) 10
tau_min, tau_max (lower and upper bounds of correlation time) [ns]: None, None
use_ext_weights (use of weights for FLCS etc.): False
use_drift_correction (use of weights for bleaching/drift correction etc.): True
use_flcs_bg_corr (use of FLCS-based background subtraction): True
use_burst_removal (removal of photons assigned as burst photons): True
use_mse_filter (removal of photons in segments with anomalous correlation function): True

Results written to ../test_data/2ch_setup/20230924_1027_SUVs_A655_bursts/42_ACF_ch1_br_dt_ar_bg.csv/png
